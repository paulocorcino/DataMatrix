/*****************************************************************

	ActiveWidgets 2.0.b1 (beta 1)
	Copyright (C) 2003-2005 ActiveWidgets Ltd. All Rights Reserved. 
	http://www.activewidgets.com/

	WARNING: This software program is protected by copyright law 
	and international treaties. Unauthorized reproduction or
	distribution of this program, or any portion of it, may result
	in severe civil and criminal penalties, and will be prosecuted
	to the maximum extent possible under the law.

	FOR TESTING AND EVALUATION ONLY:
	This software is not free and is licensed to you for testing 
	and evaluation only. You are not allowed to distribute 
	or use any parts of this software for any other purposes.

*****************************************************************/

 if(!window.AW){var AW=function(a,b){return AW.dispatch(a,b)}}if(!AW.System){AW.System={}}if(!AW.HTML){AW.HTML={}}if(!AW.Templates){AW.Templates={}}if(!AW.Scroll){AW.Scroll={}}if(!AW.Panels){AW.Panels={}}if(!AW.Formats){AW.Formats={}}if(!AW.HTTP){AW.HTTP={}}if(!AW.CSV){AW.CSV={}}if(!AW.XML){AW.XML={}}if(!AW.UI){AW.UI={}}if(!AW.Grid){AW.Grid={}}if(!AW.Tree){AW.Tree={}}if(!AW.Grid.Controllers){AW.Grid.Controllers={}}
(function(){AW.browser="";if(window.external){AW.browser="ie"}else if(window.__defineGetter__){AW.browser="gecko"}else if(window.opera){AW.browser="opera"}else if(navigator.userAgent.match("Safari")){AW.browser="safari"}AW.os="";if(!navigator.userAgent.match("Windows")){AW.unix=true}if(navigator.userAgent.match("Mac OS")){AW.os="mac"}if(navigator.userAgent.match("Linux")){AW.os="linux"}AW.strict=(document.compatMode && document.compatMode.match("CSS"))|| AW.browser=="safari";var htmlc="";if(AW.strict){htmlc+=" aw-strict"}if(AW.browser){htmlc+=" aw-"+AW.browser}if(AW.unix){htmlc+=" aw-unix"}if(AW.os){htmlc+=" aw-"+AW.os}document.getElementsByTagName("html")[0].className+=htmlc;if(AW.strict){AW.dx=8;AW.dy=4}else{AW.dx=0;AW.dy=0}AW.all={id:0};AW.dispatch=function(element,event){var parts=element.id.split("-");var tag=parts[0];var obj=AW.all[tag];var type="_on"+event.type+"Event";var target=obj;for(var i=1;i<parts.length;i++){if(obj["_"+parts[i]+"Content"]){for(var j=i;j<parts.length;j++){target=target.getContent(parts[j])}break}else if(parts[i+1] && parts[i+1].match(/^(\d+)$/)){if(parts[i+2] && parts[i+2].match(/^(\d+)$/)){if(parts[i+3] && parts[i+3].match(/^(\d+)$/)){obj=obj.getTemplate(parts[i],parts[i+1],parts[i+2],parts[i+3]);i+=3}else{obj=obj.getTemplate(parts[i],parts[i+1],parts[i+2]);i+=2}}else{obj=obj.getTemplate(parts[i],parts[i+1]);i+=1}}else{obj=obj.getTemplate(parts[i])}target=obj}if(window.HTMLElement){window.event=event}target[type].call(obj,event);if(window.HTMLElement){window.event=null}return};AW.object=function(id){var parts=id.split("-");var tag=parts[0];var obj=AW.all[tag];var target=obj;for(var i=1;i<parts.length;i++){if(obj["_"+parts[i]+"Content"]){for(var j=i;j<parts.length;j++){target=target.getContent(parts[j])}break}else if(parts[i+1] && parts[i+1].match(/^(\d+)$/)){if(parts[i+2] && parts[i+2].match(/^(\d+)$/)){if(parts[i+3] && parts[i+3].match(/^(\d+)$/)){obj=obj.getTemplate(parts[i],parts[i+1],parts[i+2],parts[i+3]);i+=3}else{obj=obj.getTemplate(parts[i],parts[i+1],parts[i+2]);i+=2}}else{obj=obj.getTemplate(parts[i],parts[i+1]);i+=1}}else{obj=obj.getTemplate(parts[i])}target=obj}return target};AW.docs=[document];AW.element=function(id){var i,e,docs=AW.docs;for(i=0;i<docs.length;i++){e=docs[i].getElementById(id);if(e){return e}}};AW.paint=function(element){var obj=AW.all[element.id];if(obj && obj.action && !obj.$paint){obj.$paint=true;obj.action("paint")}window.setTimeout(function(){element.style.removeExpression("visibility");if(obj && obj.$paint){obj.$paint=false}},0);return obj && obj.getControlVisible()?"visible":"hidden"};AW.forEach=function(array,handler){var i,empty={};for(i in array){if(!empty[i]){handler(i,array[i])}}};if(window.attachEvent){AW.attachEvent=function(element,name,handler){return element.attachEvent(name,handler)};AW.detachEvent=function(element,name,handler){return element.detachEvent(name,handler)};AW.srcElement=function(event){return event.srcElement};AW.toElement=function(event){return event.toElement};AW.setReturnValue=function(event,value){event.returnValue=value};AW.setCapture=function(element){return element.setCapture()};AW.releaseCapture=function(element){return element.releaseCapture()};AW.addRule=function(stylesheet,selector,rule){return stylesheet.addRule(selector,rule)};AW.getRules=function(stylesheet){return stylesheet.rules}}})();
(function(){if(window.addEventListener){AW.attachEvent=function(target,name,handler){return target.addEventListener(name.replace(/^on/,""),handler,false)};AW.detachEvent=function(target,name,handler){return target.removeEventListener(name.replace(/^on/,""),handler,false)};AW.srcElement=function(event){return(event.target && event.target.nodeType==3)?event.target.parentNode:event.target};AW.toElement=function(event){return(event.relatedTarget && event.relatedTarget.nodeType==3)?event.relatedTarget.parentNode:event.relatedTarget};AW.setReturnValue=function(event,value){event.preventDefault()};AW.setCapture=function(element){return};AW.releaseCapture=function(element){return};AW.addRule=function(stylesheet,selector,rule){var i=stylesheet.cssRules.length;stylesheet.insertRule(selector+"{"+rule+"}",i);stylesheet.cssRules[i].style.cssText=rule};AW.getRules=function(stylesheet){return stylesheet.cssRules}}if(window.__defineSetter__){var element=HTMLElement.prototype;var setOuterHtml=function(s){var range=this.ownerDocument.createRange();range.setStartBefore(this);var fragment=range.createContextualFragment(s);this.parentNode.replaceChild(fragment,this)};element.__defineSetter__("outerHTML",setOuterHtml)}})();
 AW.System.Object=function(){};AW.System.Object.subclass=function(){var constructor=function(){if(!constructor.created){constructor.created=true;constructor.create()}this.init()};for(var i in this){constructor[i]=this[i]}constructor.prototype=new this();constructor.superclass=this;constructor.created=false;return constructor};AW.System.Object.handle=function(error){throw(error);};AW.System.Object.create=function(){var obj=this.prototype;obj.clone=function(){if(this._clone.prototype!==this){this._clone=function(){this.init()};this._clone.prototype=this}return new this._clone()};obj._clone=function(){};obj.init=function(){};obj.handle=function(error){throw(error);};obj.timeout=function(handler,delay){var self=this;var wrapper=function(){handler.call(self)};return window.setTimeout(wrapper,delay?delay:0)};obj.toString=function(){return ""}};AW.System.Object.create();
 AW.System.Model=AW.System.Object.subclass();AW.System.Model.create=function(){var obj=this.prototype;var join=function(){var i,s=arguments[0];for(i=1;i<arguments.length;i++){s+=arguments[i].substr(0,1).toUpperCase()+arguments[i].substr(1)}return s};obj.defineProperty=function(name,value){var _getProperty=join("get",name);var _setProperty=join("set",name);var _property="_"+name;var getProperty=function(){return this[_property]};this[_setProperty]=function(value){if(typeof value=="function"){this[_getProperty]=value}else{this[_getProperty]=getProperty;this[_property]=value}};this[_setProperty](value)};var get={};var set={};obj.getProperty=function(name,a,b,c){if(!get[name]){get[name]=join("get",name)}return this[get[name]](a,b,c)};obj.setProperty=function(name,value,a,b,c){if(!set[name]){set[name]=join("set",name)}return this[set[name]](value,a,b,c)};obj.isReady=function(){return true}};
 AW.System.Format=AW.System.Object.subclass();AW.System.Format.create=function(){var obj=this.prototype;obj.valueToText=function(value){return value};obj.dataToValue=function(data){return data};obj.dataToText=function(data){var value=this.dataToValue(data);return this.valueToText(value)};obj.setErrorText=function(text){this._textError=text};obj.setErrorValue=function(value){this._valueError=value};obj.setErrorText("#ERR");obj.setErrorValue(NaN);obj.textToValue=function(text){return text};obj.textToData=function(text){return text};obj.valueToData=function(value){return value}};
 AW.System.HTML=AW.System.Object.subclass();AW.System.HTML.create=function(){var obj=this.prototype;obj.setTag=function(tag){this._tag=tag;this._outerHTML=""};obj.getTag=function(){return this._tag};obj._tag="span";obj.init=function(){if(this.$owner){return}if(this._parent){return}this._id="aw"+AW.all.id++;AW.all[this._id]=this};obj.getId=function(){return this._id};obj._id="";obj.setId=function(id){this._id=id;AW.all[this._id]=this};obj.element=function(){var i,docs=AW.docs,id=this.getId(),e;for(i=0;i<docs.length;i++){e=docs[i].getElementById(id);if(e){return e}}};obj.getClass=function(name){var param="_"+name+"Class";var value=this[param];return typeof(value)=="function"?value.call(this):value};obj.setClass=function(name,value){var element=this.element();if(element){var v=(typeof(value)=="function")?value.call(this):value;element.className=element.className.replace(new RegExp("(active-"+name+"-\\w+|$)")," active-"+name+"-"+v+" ");if(this.$index !==""){return}}if(this.data){return}var param="_"+name+"Class";if(this[param]==null){this._classes+=" "+name}this[param]=value;this._outerHTML="";if(this.lock){this.lock()}};obj.refreshClasses=function(){var element=this.element();if(!element){return}var s="",classes=this._classes.split(" ");for(var i=1;i<classes.length;i++){var name=classes[i];var value=this["_"+name+"Class"];if(typeof(value)=="function"){value=value.call(this)}s+="aw-"+name+"-"+value+" "}element.className=s};obj._classes="";obj.getStyle=function(name){var param="_"+name+"Style";var value=this[param];return typeof(value)=="function"?value.call(this):value};obj.setStyle=function(name,value){var element=this.element();if(element){element.style[name]=value}var param="_"+name+"Style";if(this[param]==null){this._styles+=" "+name}this[param]=value;this._outerHTML="";if(this.lock){this.lock()}};obj._styles="";obj.getAttribute=function(name){try{var param="_"+name+"Attribute";var value=this[param];return typeof(value)=="function"?value.call(this):value}catch(error){this.handle(error)}};obj.setAttribute=function(name,value){try{var param="_"+name+"Attribute";if(typeof this[param]=="undefined"){this._attributes+=" "+name}if(specialAttributes[name] &&(typeof value=="function")){this[param]=function(){return value.call(this)?true:null}}else{this[param]=value}this._outerHTML="";if(this.lock){this.lock()}}catch(error){this.handle(error)}};obj._attributes="";var specialAttributes={checked:true,disabled:true,hidefocus:true,readonly:true};obj.getEvent=function(name){try{var param="_"+name+"Event";var value=this[param];return value}catch(error){this.handle(error)}};obj.setEvent=function(name,value){try{var param="_"+name+"Event";if(this[param]==null){this._events+=" "+name}this[param]=value;this._outerHTML="";if(this.lock){this.lock()}}catch(error){this.handle(error)}};obj._events="";obj.getContent=function(name){try{var split=name.match(/^(\w+)\W(.+)$/);if(split){var ref=this.getContent(split[1]);return ref.getContent(split[2])}else{var param="_"+name+"Content";var value=this[param];if((typeof value=="object")&&(value._parent !=this)){value=value.clone();value._parent=this;this[param]=value}if(typeof value=="object"){value._id=this._id+"-"+name}return value}}catch(error){this.handle(error)}};obj.setContent=function(name,value){try{if(arguments.length==1){this._content="";if(typeof name=="object"){for(var i in name){if(typeof(i)=="string"){this.setContent(i,name[i])}}}else{this.setContent("html",name)}}else{var split=name.match(/^(\w+)\W(.+)$/);if(split){var ref=this.getContent(split[1]);ref.setContent(split[2],value);this._innerHTML="";this._outerHTML=""}else{var param="_"+name+"Content";if(this[param]==null){this._content+=" "+name}if(typeof value=="object"){value._parent=this;value._id=this._id+"-"+name}this[param]=value;this._innerHTML="";this._outerHTML=""}}if(this.lock){this.lock()}}catch(error){this.handle(error)}};obj._content="";obj.$index="";var getParamStr=function(i){return "{#"+i+"}"};obj.innerHTML=function(){try{if(this._innerHTML){return this._innerHTML}this._innerParamLength=0;var i,j,name,value,param1,param2,html,item,s="";var content=this._content.split(" ");for(i=1;i<content.length;i++){name=content[i];value=this["_"+name+"Content"];if(typeof(value)=="function"){param=getParamStr(this._innerParamLength++);this[param]=value;s+=param}else if(typeof(value)=="object"){item=value;html=item.outerHTML().replace(/\{id\}/g,"{id}-"+name);for(j=item._outerParamLength-1;j>=0;j--){param1=getParamStr(j);param2=getParamStr(this._innerParamLength+j);if(param1 !=param2){html=html.replace(param1,param2)}this[param2]=item[param1]}this._innerParamLength+=item._outerParamLength;s+=html}else{s+=value}}this._innerHTML=s;return s}catch(error){this.handle(error)}};obj.outerHTML=function(){try{if(this._outerHTML){return this._outerHTML}var innerHTML=this.innerHTML();this._outerParamLength=this._innerParamLength;if(!this._tag){return innerHTML}var i,tmp,name,value,param;var html="<"+this._tag+" id=\"{id}\"";tmp="";var classes=this._classes.split(" ");for(i=1;i<classes.length;i++){name=classes[i];value=this["_"+name+"Class"];if(typeof(value)=="function"){param=getParamStr(this._outerParamLength++);this[param]=value;value=param}tmp+="aw-"+name+"-"+value+" "}if(tmp){html+=" class=\""+tmp+"\""}tmp="";var styles=this._styles.split(" ");for(i=1;i<styles.length;i++){name=styles[i];value=this["_"+name+"Style"];if(typeof(value)=="function"){param=getParamStr(this._outerParamLength++);this[param]=value;value=param}tmp+=name+":"+value+";"}if(tmp){html+=" style=\""+tmp+"\""}tmp="";var attributes=this._attributes.split(" ");for(i=1;i<attributes.length;i++){name=attributes[i];value=this["_"+name+"Attribute"];if(typeof(value)=="function"){param=getParamStr(this._outerParamLength++);this[param]=value;value=param}else if(specialAttributes[name] && !value){value=null}if(value !==null){tmp+=" "+name+"=\""+value+"\""}}html+=tmp;tmp="";var events=this._events.split(" ");for(i=1;i<events.length;i++){name=events[i];value=this["_"+name+"Event"];if(typeof(value)=="function"){value="AW(this,event)"}tmp+=" "+name+"=\""+value+"\""}html+=tmp;html+=">"+innerHTML+"</"+this._tag+">";this._outerHTML=html;return html}catch(error){this.handle(error)}};obj.toString=function(){try{var i,s=this._outerHTML;if(!s){s=this.outerHTML()}s=s.replace(id_pattern,this._id);var max=this._outerParamLength;if(param_cache.length < max){for(i=param_cache.length;i<max;i++){param_cache[i]=getParamStr(i)}}for(i=0;i<max;i++){var param=param_cache[i];var value=this[param]();if(value===null){value="";param=specialParams[i];if(!param){param=getSpecialParamStr(i)}}s=s.replace(param,value)}return s}catch(error){this.handle(error)}};var id_pattern=/\{id\}/g;var param_cache=[];var specialParams=[];function getSpecialParamStr(i){return(specialParams[i]=new RegExp("[\\w\\x2D]*=?:?\\x22?\\{#"+i+"\\}[;\\x22]?"))}obj.refresh=function(){try{var element=this.element();if(element){element.outerHTML=this.toString()}}catch(error){this.handle(error)}};obj.$browser=AW.browser};
 AW.System.Template=AW.System.HTML.subclass();AW.System.Template.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var _pattern=/^(\w+)\W(.+)$/;var join=function(){var i,s=arguments[0];for(i=1;i<arguments.length;i++){s+=arguments[i].substr(0,1).toUpperCase()+arguments[i].substr(1)}return s};obj.getProperty=function(name,a,b,c){if(name.match(_pattern)){var getProperty=join("get",RegExp.$1,"property");if(this[getProperty]){return this[getProperty](RegExp.$2,a,b,c)}}};obj.setProperty=function(name,value,a,b,c){if(name.match(_pattern)){var setProperty=join("set",RegExp.$1,"property");if(this[setProperty]){return this[setProperty](RegExp.$2,value,a,b,c)}}};obj.getModel=function(name){var getModel=join("get",name,"model");return this[getModel]()};obj.setModel=function(name,model){var setModel=join("set",name,"model");return this[setModel](model)};obj._templates=[];obj.defineTemplate=function(name,template){var ref="_"+name+"Template";var ref1=ref+"1",ref2=ref+"2",ref3=ref+"3";var get=join("get",name,"template");var set=join("set",name,"template");var clone=join("_",name,"template","clone");var name1="-"+name;var name2="-"+name+"-";var undef;this[get]=function(a,b,c){if(typeof(this[ref])=="function"){return this[ref](a,b,c)}var r,id,useClone=false;if(a===undef){id=this._id+name1;r=this[ref]}else if(b===undef){id=this._id+name2+a;if(this[ref1] && this[ref1][a]){r=this[ref1][a]}else{r=this[ref];useClone=true}}else if(c===undef){id=this._id+name2+a+"-"+b;if(this[ref2] && this[ref2][a] && this[ref2][a][b]){r=this[ref2][a][b]}else if(this[ref1] && this[ref1][a]){r=this[ref1][a];useClone=true}else{r=this[ref];useClone=true}}else{id=this._id+name2+a+"-"+b+"-"+c;if(this[ref3] && this[ref3][a] && this[ref3][a][b] && this[ref3][a][b][c]){r=this[ref2][a][b][c]}else if(this[ref2] && this[ref2][a] && this[ref2][a][b]){r=this[ref2][a][b];useClone=true}else if(this[ref1] && this[ref1][a]){r=this[ref1][a];useClone=true}else{r=this[ref];useClone=true}}if(useClone || r.$owner !=this){if(!r.$clone){r.$clone=r.clone();r.$clone.$clone=null}r=r.$clone}r.$owner=this;r.$0=a;r.$1=b;r.$2=c;r._id=id;return r};obj[get]=function(a,b,c){if(a===undef){return this.$owner[get](this.$0,this.$1,this.$2)}if(b===undef){return this.$owner[get](a,this.$0,this.$1)}if(c===undef){return this.$owner[get](a,b,this.$0)}return this.$owner[get](a,b,c)};obj[set]=function(template,a,b,c){if(a===undef){if(this[ref]==template){return}if(this[ref]){this[ref].$clone=""}this[ref]=template;if(template){template.$clone="";template.$name=name;if(template.$owner !=this){template.$owner=this;this.action(name+"TemplateChanged",template)}}return}if(b===undef){if(!this[ref1]){this[ref1]={}}if(this[ref1][a]==template){return}this[ref1][a]=template;template.$clone="";template.$name=name;template.$0=a;this[ref].$clone="";if(template.$owner !=this){template.$owner=this;this.action(name+"TemplateChanged",template,a)}return}if(c===undef){if(!this[ref2]){this[ref2]={}}if(!this[ref2][a]){this[ref2][a]={}}this[ref2][a][b]=template;template.$clone="";template.$name=name;this[ref].$clone="";if(this[ref1] && this[ref1][a]){this[ref1][a].$clone=""}template.$0=a;template.$1=b;if(template.$owner !=this){template.$owner=this;this.action(name+"TemplateChanged",template,a,b)}return}};this[set](template);this._templates=this._templates.concat();this._templates.push(name)};obj.lock=function(){if(!this.$owner){return}this.$owner[join("set",this.$name,"template")](this,this.$0,this.$1,this.$2)};obj.getTemplate=function(name){if(name.match(_pattern)){var get=join("get",RegExp.$1,"template");arguments[0]=RegExp.$2;var template=this[get]();return template.getTemplate.apply(template,arguments)}else{get=join("get",name,"template");var i,args=[];for(i=1;i<arguments.length;i++){args[i-1]=arguments[i]}return this[get].apply(this,args)}};obj.setTemplate=function(name,template,index){if(name.match(_pattern)){var get=join("get",RegExp.$1,"template");var n=RegExp.$2;this[get]().setTemplate(n,template,index)}else{var set=join("set",name,"template");this[set](template,index)}};obj.getAction=function(name){return this["_"+name+"Action"]};obj.setAction=function(name,value){this[join("on",name)]=value};obj.action=function(name,source,a,b,c){if(typeof source=="undefined"){source=this;a=this.$0;b=this.$1;c=this.$2}var action=this[join("on",name)];if(typeof(action)=="function" && action.call(this,source,a,b,c)){return}else if(this.$owner){this.$owner.action(name,source,a,b,c)}};obj.action2=function(name){if(!this._defer){this._defer={};var exec=function(){var i,actions=this._defer;this._defer=null;for(i in actions){if(actions[i]===true){this.action(i)}}};this.timeout(exec)}this._defer[name]=true};obj.mapTemplate=function(source,target){var get=join("get",source,"template");if(typeof(target)=="function"){this[get]=target}else{var u,m=join("get",target,"template");this[get]=function(a,b,c){if(a===u){return this.$owner[m](this.$0,this.$1,this.$2)}if(b===u){return this.$owner[m](a,this.$0,this.$1)}if(c===u){return this.$owner[m](a,b,this.$0)}return this.$owner[m](a,b,c)}}this.lock()};obj.mapModel=function(source,target,target2){var get=join("get",source,"property");var set=join("set",source,"property");if(typeof(target)=="function"){this[get]=target;if(typeof(target2)=="function"){this[set]=target2}else{this[set]=function(){}}}else{var _get=join("get",target,"property");var _set=join("set",target,"property");var u;this[get]=function(p,a,b,c){if(a===u){return this.$owner[_get](p,this.$0,this.$1,this.$2)}if(b===u){return this.$owner[_get](p,a,this.$0,this.$1)}if(c===u){return this.$owner[_get](p,a,b,this.$0)}return this.$owner[_get](p,a,b,c)};this[set]=function(p,v,a,b,c){if(a===u){return this.$owner[_set](p,v,this.$0,this.$1,this.$2)}if(b===u){return this.$owner[_set](p,v,a,this.$0,this.$1)}if(c===u){return this.$owner[_set](p,v,a,b,this.$0)}return this.$owner[_set](p,v,a,b,c)}}this.lock()}};
 AW.System.Control=AW.System.Template.subclass();AW.System.Control.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var _pattern=/^(\w+)\W(.+)$/;function cc(){var i,s=arguments[0];for(i=1;i<arguments.length;i++){s+=arguments[i].substr(0,1).toUpperCase()+arguments[i].substr(1)}return s}obj.setTag("span");obj.setClass("system","control");obj.setAttribute("aw","control");obj.setEvent("oncontextmenu","return false");obj.setEvent("onselectstart","return false");obj.defineModel=function(m,z){var ext="_"+m+"Model";var defineProperty=cc("define",m,"property");var definePropertyArray=cc("define",m,"property","array");var getProperty=cc("get",m,"property");var setProperty=cc("set",m,"property");var getModel=cc("get",m,"model");var setModel=cc("set",m,"model");var clearModel=cc("clear",m);var _modelChanged=cc(m,"changed");var getInt={};var setInt={};var getExt={};var setExt={};var changing={};var changed={};var undef;this[defineProperty]=function(p,v,arrayValue){var _p="_"+cc(m,p);var _p1=_p+"1";var _p2=_p+"2";var _p3=_p+"3";var get=cc("get",m,p);var set=cc("set",m,p);var _get=(getInt[p]=cc("_get",m,p));var _set=(setInt[p]=cc("_set",m,p));var $get=(getExt[p]=cc("get",p));var $set=(setExt[p]=cc("set",p));var _changing=(changing[p]=cc(m,p,"changing"));var _changed=(changed[p]=cc(m,p,"changed"));this[get]=function(a,b,c){if(this[ext] && this[ext][$get]){return this[ext][$get](a,b,c)}return this[_get](a,b,c)};this[set]=function(v,a,b,c){if(this[ext] && this[ext][$set]){return this[ext][$set](v,a,b,c)}this.action(_changing,v,a,b,c);this[_set](v,a,b,c);this.action(_changed,v,a,b,c);this.action2(_modelChanged)};function init(){var undef;this[_get]=function(a,b,c){var r;if(c !==undef && this[_p3] && this[_p3][c] && this[_p3][c][b] && this[_p3][c][b][a] !==undef){r=this[_p3][c][b][a]}else if(b !==undef && this[_p2] && this[_p2][b] && this[_p2][b][a] !==undef){r=this[_p2][b][a]}else if(a !==undef && this[_p1] && this[_p1][a] !==undef){r=this[_p1][a]}else{r=this[_p]}return(typeof(r)=="function")?r.call(this,a,b,c):r};var default_get=this[_get];this[_set]=function(v,a,b,c){this[_get]=default_get;var i;if(v && v.constructor==Array && !arrayValue){for(i in v){if(v[i] && v[i].constructor==Array){this[_p2]=v;delete this[_p3];return}break}if(a !==undef){if(!this[_p2]){this[_p2]={}}this[_p2][a]=v;delete this[_p3]}else{this[_p1]=v;delete this[_p2];delete this[_p3]}return}if(c !==undef){if(!this[_p3]){this[_p3]={}}if(!this[_p3][c]){this[_p3][c]={}}if(!this[_p3][c][b]){this[_p3][c][b]={}}this[_p3][c][b][a]=v}else if(b !==undef){if(!this[_p2]){this[_p2]={}}if(!this[_p2][b]){this[_p2][b]={}}this[_p2][b][a]=v}else if(a !==undef){if(!this[_p1]){this[_p1]={$owner:this}}else if(this[_p1].$owner !=this){var r=this[_p1];this[_p1]={};for(i in r){this[_p1][i]=r[i]}this[_p1].$owner=this}this[_p1][a]=v}else{this[_p]=v;delete this[_p1];delete this[_p2];delete this[_p3]}};this[_set](v)}init.call(this);var clear=this[clearModel];this[clearModel]=function(){clear.call(this);init.call(this)}};this[getProperty]=function(p,a,b,c){try{if(this[ext] && this[ext][getExt[p]]){return this[ext][getExt[p]](a,b,c)}return this[getInt[p]](a,b,c)}catch(error){return this.handle(error)}};this[setProperty]=function(p,v,a,b,c){try{if(this[ext] && this[ext][setExt[p]]){return this[ext][setExt[p]](v,a,b,c)}this.action(changing[p],v,a,b,c);this[setInt[p]](v,a,b,c);this.action(changed[p],v,a,b,c);this.action2(_modelChanged)}catch(error){return this.handle(error)}};_super[getProperty]=function(p,a,b,c){if(a===undef){return this.$owner[getProperty](p,this.$0,this.$1,this.$2)}if(b===undef){return this.$owner[getProperty](p,a,this.$0,this.$1)}if(c===undef){return this.$owner[getProperty](p,a,b,this.$0)}return this.$owner[getProperty](p,a,b,c)};_super[setProperty]=function(p,v,a,b,c){if(a===undef){return this.$owner[setProperty](p,v,this.$0,this.$1,this.$2)}if(b===undef){return this.$owner[setProperty](p,v,a,this.$0,this.$1)}if(c===undef){return this.$owner[setProperty](p,v,a,b,this.$0)}return this.$owner[setProperty](p,v,a,b,c)};var proxyPrototype=new AW.System.Model;proxyPrototype.getProperty=function(p,a,b,c){return this._target[getProperty](p,a,b,c)};proxyPrototype.setProperty=function(p,v,a,b,c){return this._target[setProperty](p,v,a,b,c)};var proxy=cc("_",m,"proxy");this[getModel]=function(){if(this[ext]){return this[ext]}if(!this[proxy]){this[proxy]=proxyPrototype.clone();this[proxy]._target=this;this[proxy].$owner=this.$owner}return this[proxy]};_super[setModel]=function(model){this[ext]=model;if(model && !model.$owner){model.$owner=this}};_super[getModel]=function(a,b,c){if(this[ext]){return this[ext]}return this.$owner[getModel](a,b,c)};this[clearModel]=function(){this[ext]=null};var i,zz={};for(i in z){if(!zz[i]){this[defineProperty](i,z[i])}}};obj.defineProperty=function(name,defaultValue){if(name.match(_pattern)){var defineProperty=cc("define",RegExp.$1,"property");if(this[defineProperty]){return this[defineProperty](RegExp.$2,defaultValue)}}};obj.defineModel("tab",{index:1});obj.defineModel("control",{text:"",image:"",value:"",link:"",tooltip:"",state:"",visible:true});obj.setControlSize=function(width,height){if(typeof(width)!="undefined"){this.setStyle("width",width - AW.dx+"px")}if(typeof(height)!="undefined"){this.setStyle("height",height - AW.dy+"px")}};obj.setControlPosition=function(left,top,width,height){this.setStyle("position","absolute");if(typeof(left)!="undefined"){this.setStyle("left",left+"px")}if(typeof(top)!="undefined"){this.setStyle("top",top+"px")}if(typeof(width)!="undefined"){this.setStyle("width",width - AW.dx+"px")}if(typeof(height)!="undefined"){this.setStyle("height",height - AW.dy+"px")}};obj.setController=function(name,controller){var i,n="_"+name+"Controller";this[n]=controller;for(i=0;i<this._controllers.length;i++){if(this._controllers[i]==n){return}}this._controllers=this._controllers.concat();this._controllers.push(n)};obj._controllers=[];obj.action=function(name,source,a,b,c){var i,n=cc("on",name);var action=this[n];if(typeof(action)=="function" && action.call(this,source,a,b,c)){return}for(i=0;i<this._controllers.length;i++){action=this[this._controllers[i]]?this[this._controllers[i]][name]:null;if(typeof(action)=="function"){action.call(this,source,a,b,c)}else if(typeof(action)=="string" && action !=name){this.action(action,source,a,b,c)}}};var keyNames={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"};obj.setEvent("onkeydown",function(event){var key=keyNames[event.keyCode];if(key){if(event.shiftKey){key="Shift"+key}if(event.altKey){key="Alt"+key}if(event.ctrlKey){key="Ctrl"+key}this.action("key"+key,event);event.cancelBubble=true}});var mouseBlocked=false;obj._blockMouse=function(n){mouseBlocked=true;AW.forEach(handlers,function(name,handler){AW.detachEvent(document,name,handler)});this.timeout(function(){mouseBlocked=false;AW.forEach(handlers,function(name,handler){AW.attachEvent(document,name,handler)})},n || 5000)};var targets={};function raiseAction(name,element,event){var a=((element.id.match(/-*\d*-*\d*-*\d+$/)|| ["-"])+"").split("-");var target=AW.object(element.id);if(target && target.action){target.action(name,event,a[1],a[2],a[3])}}function handleMouse(e,event){try{if(mouseBlocked){return}var i,t={};while(e){if(e.getAttribute &&(e.getAttribute("aw")||e.getAttribute("awx"))){t[e.id]=true}e=e.parentNode}for(i in targets){if(!t[i]){e=AW.element(i);if(e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"MouseOut",e,event);if(e.getAttribute("aw")!="control"){e.className=e.className.replace(/ aw-mouseover-\w+/g,"")}}if(e.getAttribute("awx")){raiseAction(e.getAttribute("awx")+"MouseOut",e,event);e.className=e.className.replace(/ aw-mouseover-\w+/g,"")}}}for(i in t){if(!targets[i]){e=AW.element(i);if(e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"MouseOver",e,event);if(e.getAttribute("aw")!="control"){e.className+=" aw-mouseover-"+e.getAttribute("aw").toLowerCase()}}if(e.getAttribute("awx")){raiseAction(e.getAttribute("awx")+"MouseOver",e,event);e.className+=" aw-mouseover-"+e.getAttribute("awx").toLowerCase()}}}targets=t}catch(error){}}var empty={};var handlers={onmousemove:function(event){handleMouse(AW.srcElement(event),event)},onmouseover:function(event){handleMouse(AW.srcElement(event),event)},onmouseout:function(event){handleMouse(AW.toElement(event),event)},onmousedown:function(event){try{var e=AW.srcElement(event);while(e){if(e.getAttribute && e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"MouseDown",e,event);if(e.getAttribute("aw")!="control"){e.className+=" aw-mousedown-"+e.getAttribute("aw").toLowerCase()}}if(e.getAttribute && e.getAttribute("awx")){raiseAction(e.getAttribute("awx")+"MouseDown",e,event);e.className+=" aw-mousedown-"+e.getAttribute("awx").toLowerCase()}e=e.parentNode}}catch(x){}},onmouseup:function(event){try{var e=AW.srcElement(event);while(e){if(e.getAttribute && e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"MouseUp",e,event);if(e.getAttribute("aw")!="control"){e.className=e.className.replace(/ aw-mousedown-\w+/g,"")}}if(e.getAttribute && e.getAttribute("awx")){raiseAction(e.getAttribute("awx")+"MouseUp",e,event);e.className=e.className.replace(/ aw-mousedown-\w+/g,"")}e=e.parentNode}}catch(x){}},onclick:function(event){try{var e=AW.srcElement(event);while(e){if(e.getAttribute && e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"Clicked",e,event)}if(e.getAttribute && e.getAttribute("awx")){raiseAction(e.getAttribute("awx")+"Clicked",e,event)}e=e.parentNode}}catch(x){}},ondblclick:function(event){try{var e=AW.srcElement(event);while(e){if(e.getAttribute && e.getAttribute("aw")){raiseAction(e.getAttribute("aw")+"DoubleClicked",e,event)}e=e.parentNode}}catch(x){}}};function onunload(){AW.forEach(handlers,function(name,handler){AW.detachEvent(document,name,handler)})}AW.forEach(handlers,function(name,handler){AW.attachEvent(document,name,handler)});AW.attachEvent(window,"onunload",onunload);AW.registerDocument=function(doc){AW.forEach(handlers,function(name,handler){AW.attachEvent(doc,name,handler)})};AW.unregisterDocument=function(doc){var i,docs=AW.docs;for(i=0;i<docs.length;i++){if(docs[i]===doc){docs.splice(i,1);return}}AW.forEach(handlers,function(name,handler){AW.detachEvent(doc,name,handler)})}};
 AW.Formats.String=AW.System.Format.subclass();AW.Formats.String.create=function(){var obj=this.prototype;obj.dataToValue=function(data){return data.toUpperCase()};obj.dataToText=function(data){return data}};
 AW.Formats.Number=AW.System.Format.subclass();AW.Formats.Number.create=function(){var obj=this.prototype;obj.dataToValue=function(data){return Number(data)};obj.textToValue=function(text){return Number(text)};var noFormat=function(value){return ""+value};var doFormat=function(value){var multiplier=this._multiplier;var abs=(value<0)?-value:value;var delta=(value<0)?-0.5:+0.5;var rounded=(Math.round(value * multiplier)+delta)/multiplier+"";if(abs<1000){return rounded.replace(this.p1,this.r1)}if(abs<1000000){return rounded.replace(this.p2,this.r2)}if(abs<1000000000){return rounded.replace(this.p3,this.r3)}return rounded.replace(this.p4,this.r4)};obj.setTextFormat=function(format){var pattern=/^([^0#]*)([0#]*)([ .,]?)([0#]|[0#]{3})([.,])([0#]*)([^0#]*)$/;var f=format.match(pattern);if(!f){this.valueToText=noFormat;return}this.valueToText=doFormat;var rs=f[1];var rg=f[3];var rd=f[5];var re=f[7];var decimals=f[6].length;this._multiplier=Math.pow(10,decimals);var ps="^(-?\\d+)",pm="(\\d{3})",pe="\\.(\\d{"+decimals+"})\\d$";this.p1=new RegExp(ps+pe);this.p2=new RegExp(ps+pm+pe);this.p3=new RegExp(ps+pm+pm+pe);this.p4=new RegExp(ps+pm+pm+pm+pe);this.r1=rs+"$1"+rd+"$2"+re;this.r2=rs+"$1"+rg+"$2"+rd+"$3"+re;this.r3=rs+"$1"+rg+"$2"+rg+"$3"+rd+"$4"+re;this.r4=rs+"$1"+rg+"$2"+rg+"$3"+rg+"$4"+rd+"$5"+re};obj.setTextFormat("#.##")};
 AW.Formats.Date=AW.System.Format.subclass();AW.Formats.Date.create=function(){var obj=this.prototype;obj.date=new Date();obj.digits=[];obj.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];obj.longMonths=["January","February","March","April","May","June","July","August","September","October","November","December"];obj.shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];obj.longWeekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(var i=0;i<100;i++){obj.digits[i]=i<10?"0"+i:""+i}var tokens={"hh":"this.digits[this.date.getUTCHours()]",":mm":"':'+this.digits[this.date.getUTCMinutes()]","mm:":"this.digits[this.date.getUTCMinutes()]+':'","ss":"this.digits[this.date.getUTCSeconds()]","dddd":"this.longWeekdays[this.date.getUTCDay()]","ddd":"this.shortWeekdays[this.date.getUTCDay()]","dd":"this.digits[this.date.getUTCDate()]","d":"this.date.getUTCDate()","mmmm":"this.longMonths[this.date.getUTCMonth()]","mmm":"this.shortMonths[this.date.getUTCMonth()]","mm":"this.digits[this.date.getUTCMonth()+1]","m":"(this.date.getUTCMonth()+1)","yyyy":"this.date.getUTCFullYear()","yy":"this.digits[this.date.getUTCFullYear()%100]"};var match="";for(i in tokens){if(typeof(i)=="string"){match+="|"+i}}var re=new RegExp(match.replace("|","(")+")","gi");obj.setTextFormat=function(format){format=format.replace(re,function(i){return "'+"+tokens[i.toLowerCase()]+"+'"});format="if(isNaN(value)||(value===this._valueError))return this._textError;"+"this.date.setTime(value+this._textTimezoneOffset);"+("return '"+format+"'").replace(/(''\+|\+'')/g,"");this.valueToText=new Function("value",format)};var xmlExpr=/^(....).(..).(..).(..).(..).(..)........(...).(..)/;var xmlOut="$1/$2/$3 $4:$5:$6 GMT$7$8";var auto=function(data){var value=Date.parse(data+this._dataTimezoneCode);return isNaN(value)?this._valueError:value};var RFC822=function(data){var value=Date.parse(data);return isNaN(value)?this._valueError:value};var ISO8061=function(data){var value=Date.parse(data.replace(xmlExpr,xmlOut));return isNaN(value)?this._valueError:value};obj.setDataFormat=function(format){if(format=="RFC822"){this.dataToValue=RFC822}else if(format=="ISO8061"){this.dataToValue=ISO8061}else{this.dataToValue=auto}};obj.setTextTimezone=function(value){this._textTimezoneOffset=value};obj.setDataTimezone=function(value){if(!value){this._dataTimezoneCode=" GMT"}else{this._dataTimezoneCode=" GMT"+(value>0?"+":"-")+this.digits[Math.floor(Math.abs(value/3600000))]+this.digits[Math.abs(value/60000)%60]}};var localTimezone=- obj.date.getTimezoneOffset()* 60000;obj.setTextTimezone(localTimezone);obj.setDataTimezone(localTimezone);obj.setTextFormat("d mmm yy");obj.setDataFormat("default")};
 AW.Formats.HTML=AW.System.Format.subclass();AW.Formats.HTML.create=function(){var obj=this.prototype;obj.dataToValue=function(data){return data.toUpperCase()};obj.dataToText=function(data){return data};obj.textToValue=function(text){return text.replace(/<[^>]+>/g,"")}};
 AW.HTML.define=function(name,tag,type){if(!tag){tag=name.toLowerCase()}AW.HTML[name]=AW.System.HTML.subclass();AW.HTML[name].create=function(){};AW.HTML[name].prototype.setTag(tag)};AW.HTML.define("DIV");AW.HTML.define("SPAN");AW.HTML.define("IMG");AW.HTML.define("INPUT");AW.HTML.define("BUTTON");AW.HTML.define("TEXTAREA");AW.HTML.define("TABLE");AW.HTML.define("TR");AW.HTML.define("TD");
 AW.Templates.ImageText=AW.System.Template.subclass();AW.Templates.ImageText.create=function(){var obj=this.prototype;function _image(){return this.getControlProperty("image")|| "none"}function _text(){return this.getControlProperty("text")}var span=AW.HTML.SPAN;var image=new span;image.setClass("item","image");image.setClass("image",_image);var ruler=new span;ruler.setClass("item","ruler");var text=new span;text.setClass("item","text");text.setContent("html",_text);var box=new span;box.setClass("item","box");box.setContent("sign","");box.setContent("marker","");box.setContent("image",image);box.setContent("ruler",ruler);box.setContent("text",text);obj.setTag("span");obj.setClass("item","template");obj.setClass("templates","imagetext");obj.setContent("box",box)};AW.Templates.TextImage=AW.Templates.ImageText;
 AW.Templates.Image=AW.Templates.ImageText.subclass();AW.Templates.Image.create=function(){var obj=this.prototype;obj.setClass("templates","image");var box=obj.getContent("box");box.setTag("");box.setContent("text","")};
 AW.Templates.Text=AW.Templates.ImageText.subclass();AW.Templates.Text.create=function(){var obj=this.prototype;obj.setClass("templates","text");var box=obj.getContent("box");box.setTag("");box.setContent("image","")};
 AW.Templates.Link=AW.Templates.ImageText.subclass();AW.Templates.Link.create=function(){var obj=this.prototype;obj.setTag("a");obj.setClass("templates","link");obj.setAttribute("tabIndex","-1");obj.setAttribute("href",function(){return this.getControlProperty("link")|| null});var box=obj.getContent("box");box.setTag("")};
 AW.Templates.CheckBox=AW.Templates.ImageText.subclass();AW.Templates.CheckBox.create=function(){var obj=this.prototype;obj.setClass("value",function(){return this.getControlProperty("value")|| false});obj.setClass("toggle","checkbox");obj.setClass("templates","checkbox");obj.setAttribute("awx","toggle");var marker=new AW.HTML.SPAN;marker.setClass("item","marker");obj.setContent("box/marker",marker);obj.onToggleClicked=function(){var value=this.getControlProperty("value");this.setControlProperty("value",!value)}};AW.Templates.Checkbox=AW.Templates.CheckBox;
 AW.Templates.CheckedItem=AW.Templates.CheckBox.subclass();AW.Templates.CheckedItem.create=function(){var obj=this.prototype;obj.setClass("templates","checkeditem");obj.setClass("value",function(){return this.getStateProperty("selected")|| false});obj.onToggleClicked=function(){var selected=this.getStateProperty("selected");this.setStateProperty("selected",!selected)}};
 AW.Templates.Radio=AW.Templates.CheckedItem.subclass();AW.Templates.Radio.create=function(){var obj=this.prototype;obj.setClass("toggle","radio");obj.setClass("templates","radio");obj.onItemClicked=""};
 AW.Templates.Popup=AW.System.Template.subclass();AW.Templates.Popup.create=function(){var obj=this.prototype;obj.setClass("popup","box");obj.show=function(){var popup=window.createPopup();this.$popup=popup;var doc=popup.document;doc.open();doc.parentWindow.AW=AW;AW.docs.push(doc);doc.write("<html><head>");for(var i=0;i<document.styleSheets.length;i++){if(document.styleSheets[i].href){doc.write("<link href=\""+document.styleSheets[i].href+"\" rel=\"stylesheet\" type=\"text/css\">")}}doc.write("</head><body class='aw-popup-window'>");doc.write(this.toPopup());doc.write("</body></html>");doc.close();var ref=this.$owner.element()?this.$owner.element():document.body;var left=0;var top=ref.offsetHeight;var width=ref.offsetWidth;var height=1;popup.show(left,top,width,height,ref);AW.registerDocument(doc);if(this.$browser=="gecko"){this.timeout(function(){width=Math.max(doc.body.firstChild.scrollWidth+5,width);height=Math.max(doc.body.firstChild.scrollHeight+5,50);popup.show(left,top,width,height,ref)},100)}else{width=Math.max(doc.body.firstChild.scrollWidth+5,width);height=Math.max(doc.body.firstChild.scrollHeight+5,50);popup.show(left,top,width,height,ref)}function checkIfOpen(){if(!popup.isOpen){AW.unregisterDocument(doc);delete this.$popup}else{this.timeout(checkIfOpen,500)}}checkIfOpen.call(this)};obj.hide=function(){if(this.$popup){this.$popup.hide()}};obj.setContent("html",function(){return this.getLayoutTemplate()});obj.toPopup=obj.toString;obj.toString=function(){return ""}};
 AW.Templates.List=AW.System.Template.subclass();AW.Templates.List.create=function(){var obj=this.prototype;obj.setTag("span");obj.setClass("templates","list");obj.setContent("start","");obj.setContent("items",function(){var i,ii,a=[];var count=this.getViewProperty("count");var offset=this.getViewProperty("offset");var indices=this.getViewProperty("indices");for(i=0;i<count;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getItemTemplate(ii).toString()}return a.join("")});obj.setContent("end","")};
 AW.Scroll.Bars=AW.System.Template.subclass();AW.Scroll.Bars.create=function(){var obj=this.prototype;obj.setClass("scroll","bars");obj.setClass("scrollbars",function(){return this.getScrollProperty("bars")});var span=AW.HTML.SPAN;var box=new span;var spacer=new span;var content=new span;box.setClass("bars","box");spacer.setClass("bars","spacer");content.setClass("bars","content");spacer.setStyle("width",function(){return this.getScrollProperty("width")+"px"});spacer.setStyle("height",function(){return this.getScrollProperty("height")+"px"});if(AW.strict && AW.browser=="ie"){content.setStyle("width","expression(this.parentElement.clientWidth-20)");content.setStyle("height","expression(this.parentElement.clientHeight-20)")}obj.setContent("box",box);obj.setContent("box/spacer",spacer);obj.setContent("content",content);obj.setContent("content/html",function(){return this.getContentTemplate()});obj.setEvent("onresize",function(){this.action("adjustScrollBars")});box.setEvent("onscroll",function(){var e=this.getContent("box").element();var left=this.getScrollProperty("left");var top=this.getScrollProperty("top");if(e.scrollLeft !=left){this.setScrollProperty("left",e.scrollLeft)}if(e.scrollTop !=top){this.setScrollProperty("top",e.scrollTop)}e=null});obj.setEvent("onmousewheel",function(event){var top=this.getScrollProperty("top");top -=event.wheelDelta/2;var e=this.element();if(e){var max=this.getScrollProperty("height")- e.offsetHeight;var bars=this.getScrollProperty("bars");max+=(bars=="horizontal" || bars=="both")?16:0;top=top > max?max:top}top=top < 0?0:top;this.setScrollProperty("top",top)})};
 AW.Panels.Horizontal=AW.System.Template.subclass();AW.Panels.Horizontal.create=function(){var obj=this.prototype;obj.setClass("hpanel","template");var span=AW.HTML.SPAN;var box=new span;var top=new span;var middle=new span;var bottom=new span;box.setClass("hpanel","box");top.setClass("hpanel","top");middle.setClass("hpanel","middle");bottom.setClass("hpanel","bottom");function height(i){return function(){return this.getPanelProperty("height",i)+"px"}}function visibility(i){return function(){return this.getPanelProperty("height",i)?"visible":"hidden"}}top.setStyle("visibility",visibility(0));top.setStyle("height",height(0));bottom.setStyle("display",function(){return this.getPanelProperty("height",2)?null:"none"});bottom.setStyle("height",height(2));box.setStyle("padding-top",height(0));box.setStyle("padding-bottom",height(2));if(AW.strict && AW.browser=="ie"){box.setStyle("height","expression(this.parentElement.clientHeight-this.firstChild.offsetHeight-this.lastChild.offsetHeight)")}if(AW.browser=="safari"){middle.setStyle("top",function(){return this.getPanelProperty("height",0)+"px"});middle.setStyle("bottom",function(){return this.getPanelProperty("height",2)+"px"})}function panel(i){return function(){return this.getPanelTemplate(i)}}top.setContent("html",panel(0));middle.setContent("html",panel(1));bottom.setContent("html",panel(2));box.setContent("top",top);box.setContent("middle",middle);box.setContent("bottom",bottom);obj.setContent("box",box)};
 AW.Panels.Vertical=AW.System.Template.subclass();AW.Panels.Vertical.create=function(){var obj=this.prototype;obj.setClass("vpanel","template");var span=AW.HTML.SPAN;var box=new span;var left=new span;var center=new span;var right=new span;box.setClass("vpanel","box");left.setClass("vpanel","left");center.setClass("vpanel","center");right.setClass("vpanel","right");left.setContent("html",function(){return this.getPanelTemplate(0)});center.setContent("html",function(){return this.getPanelTemplate(1)});right.setContent("html",function(){return this.getPanelTemplate(2)});box.setContent("left",left);box.setContent("center",center);box.setContent("right",right);obj.setContent("box",box)};
 AW.Panels.Grid=AW.System.Template.subclass();AW.Panels.Grid.create=function(){var obj=this.prototype;obj.setClass("gpanel","template");var span=AW.HTML.SPAN;var box=new span;var top=new span;var middle=new span;var bottom=new span;box.setClass("gpanel","box");top.setClass("gpanel","top");middle.setClass("gpanel","middle");bottom.setClass("gpanel","bottom");function height(i){return function(){return this.getPanelProperty("height",i)+"px"}}function width(i){return function(){return this.getPanelProperty("width",i)+"px"}}function visibility(i){return function(){return this.getPanelProperty("height",i)?"visible":"hidden"}}function display(i){return function(){return this.getPanelProperty("display",i)?null:"none"}}top.setStyle("visibility",visibility(0));top.setStyle("height",height(0));bottom.setStyle("visibility",visibility(2));bottom.setStyle("height",height(2));box.setStyle("padding-top",height(0));box.setStyle("padding-bottom",height(2));function panel(i,j){return function(){return this.getPanelTemplate(i,j)}}var i,rows=[top,middle,bottom];for(i=0;i<3;i++){var left=new span;var center=new span;var right=new span;left.setClass("gpanel","left");center.setClass("gpanel","center");right.setClass("gpanel","right");left.setContent("html",panel(i,0));center.setContent("html",panel(i,1));right.setContent("html",panel(i,2));rows[i].setContent("left",left);rows[i].setContent("center",center);rows[i].setContent("right",right)}box.setContent("top",top);box.setContent("middle",middle);box.setContent("bottom",bottom);obj.setContent("box",box)};
 AW.UI.ImageText=AW.System.Control.subclass();AW.UI.ImageText.create=function(){AW.Templates.ImageText.create.call(this);var obj=this.prototype;obj.setClass("templates","");obj.setClass("ui","imagetext");obj.setClass("item","control");obj.setClass("text","expand");function _tooltip(){return this.getControlProperty("tooltip")|| null}obj.setAttribute("title",_tooltip);function _tabIndex(){return this.getTabProperty("index")}obj.getContent("box/text").setAttribute("tabIndex",_tabIndex);var _refresh=function(){this.refresh()};var itemController={controlTextChanged:_refresh,controlImageChanged:_refresh,controlValueChanged:_refresh,controlLinkChanged:_refresh,controlTooltipChanged:_refresh,controlStateChanged:_refresh};obj.setController("item",itemController)};
 AW.UI.Label=AW.UI.ImageText.subclass();AW.UI.Label.create=function(){var obj=this.prototype;obj.setClass("ui","label")};
 AW.UI.Group=AW.UI.ImageText.subclass();AW.UI.Group.create=function(){var obj=this.prototype;obj.setTag("fieldset");obj.setClass("ui","group");obj.setClass("text","normal");var box=obj.getContent("box");box.setTag("legend");box.setClass("item","legend")};
 AW.UI.Button=AW.UI.ImageText.subclass();AW.UI.Button.create=function(){var obj=this.prototype;obj.setClass("ui","button");obj.setAttribute("awx","button");obj.setController("button",{controlClicked:"click",keySpace:"click",keyEnter:"click"})};
 AW.UI.Link=AW.UI.ImageText.subclass();AW.UI.Link.create=function(){AW.Templates.Link.create.call(this);var obj=this.prototype;obj.setClass("ui","link")};
 AW.UI.Input=AW.UI.ImageText.subclass();AW.UI.Input.create=function(){var obj=this.prototype;obj.setEvent("onselectstart",function(event){event.cancelBubble=true});obj.setClass("ui","input");obj.setClass("text","wrap");var text=new AW.HTML.INPUT;text.setClass("item","text");text.setAttribute("type","text");text.setAttribute("value",function(){return this.getControlProperty("text")});if(AW.browser=="safari"){text=new AW.HTML.DIV;text.setClass("item","text");text.setAttribute("contentEditable","true");text.setContent("html",function(){return this.getControlProperty("text")})}obj.setContent("box/text",text);function update(){var value=this.getContent("box/text").element().value;this.setControlProperty("text",value);if(this.$owner){this.$owner.action("update",value,this.$0,this.$1,this.$2)}}obj.onKeyEnter=function(){update.call(this)};obj.setEvent("onchange",function(){update.call(this)})};
 AW.UI.List=AW.System.Control.subclass();AW.UI.List.create=function(){var obj=this.prototype;var box=new AW.HTML.SPAN;obj.setAttribute("tabIndex",1);obj.setAttribute("hideFocus","true");obj.setClass("ui","list");obj.setClass("list","control");obj.setClass("flow","vertical");obj.setClass("text","normal");box.setClass("list","box");box.setContent("html",function(){return this.getLayoutTemplate()});obj.setContent("box",box);obj.onItemTemplateChanged=function(item){item.setClass("list","item");item.setClass("items",function(){return this.getControlProperty("state")|| "normal"});item.setAttribute("aw","item");item.mapModel("control","item");item.mapModel("state","item")};obj.onContentTemplateChanged=function(view){view.setClass("list","template")};obj.defineTemplate("layout",function(){return this.getScrollTemplate()});obj.defineTemplate("scroll",function(){return this.getContentTemplate()});obj.defineTemplate("content",new AW.Templates.List);obj.defineTemplate("item",new AW.Templates.ImageText);function viewNext(i){var p=Math.min(this.getViewPosition(i)+1,this.getViewOffset()+this.getViewCount()- 1);var a=this.getViewIndices();return a?a[p]:p}function viewPrevious(i){var p=Math.max(this.getViewPosition(i)- 1,this.getViewOffset());var a=this.getViewIndices();return a?a[p]:p}function viewFirst(){var p=this.getViewOffset();var a=this.getViewIndices();return a?a[p]:p}function viewLast(){var p=this.getViewOffset()+this.getViewCount()- 1;var a=this.getViewIndices();return a?a[p]:p}var itemModel={count:0,text:"",image:"",value:"",link:"",tooltip:"",state:"",selected:false};var viewModel={offset:0,count:function(){return this.getItemCount()},position:function(i){return Number(i)},next:viewNext,previous:viewPrevious,first:viewFirst,last:viewLast,expanded:false};var selectionModel={mode:"single"};var selectedModel={};var currentModel={item:0};obj.defineModel("item",itemModel);obj.defineModel("state",{});obj.defineModel("view",viewModel);obj.defineModel("selection",selectionModel);obj.defineModel("selected",selectedModel);obj.defineModel("current",currentModel);obj.defineViewProperty("indices","",true);obj.defineSelectedProperty("items",[],true);function refresh(v,i){this.getItemTemplate(i).refresh()}var itemController={itemTextChanged:refresh,itemImageChanged:refresh,itemValueChanged:refresh,itemLinkChanged:refresh,itemTooltipChanged:refresh,itemStateChanged:refresh};obj.setController("item",itemController);obj.setController("view",{viewIndicesChanged:function(indices){var positions=[];for(var i=0;i<indices.length;i++){positions[indices[i]]=i}this.setViewPosition(positions);this.refresh()}});function go(dir,select){return function(event,index){var i=(dir=="this")?index:this.getCurrentItem();switch(dir){case "next":i=this.getViewNext(i);break;case "previous":i=this.getViewPrevious(i);break;case "first":i=this.getViewFirst();break;case "last":i=this.getViewLast();break}if(select){this.setSelectedItems([i])}this.setCurrentItem(i);event.returnValue=false}}function toggleThis(event,i){this.setItemSelected(!this.getItemSelected(i),i);this.setCurrentItem(i)}function toggleCurrent(){var i=this.getCurrentItem();this.setItemSelected(!this.getItemSelected(i),i)}var kb1={keyHome:"selectFirstItem",keyEnd:"selectLastItem",keyUp:"selectPreviousItem",keyDown:"selectNextItem",keyLeft:"selectPreviousItem",keyRight:"selectNextItem",keyPageUp:"selectPreviousPage",keyPageDown:"selectNextPage"};var kb2={keyHome:"selectFirstItem",keyEnd:"selectLastItem",keyUp:"selectPreviousItem",keyDown:"selectNextItem",keyPageUp:"selectPreviousPage",keyPageDown:"selectNextPage",keyCtrlHome:"gotoFirstItem",keyCtrlEnd:"gotoLastItem",keyCtrlUp:"gotoPreviousItem",keyCtrlDown:"gotoNextItem",keyCtrlPageUp:"gotoPreviousPage",keyCtrlPageDown:"gotoNextPage",keyCtrlSpace:"toggleCurrent",keySpace:"toggleCurrent"};var ms1={itemClicked:"selectThisItem"};var ms2={itemClicked:"toggleThisItem"};var cur1={gotoThisItem:go("this"),gotoPreviousItem:go("previous"),gotoNextItem:go("next"),gotoPreviousPage:go("pageup"),gotoNextPage:go("pagedown"),gotoFirstItem:go("first"),gotoLastItem:go("last"),selectThisItem:go("this",true),selectPreviousItem:go("previous",true),selectNextItem:go("next",true),selectPreviousPage:go("pageup",true),selectNextPage:go("pagedown",true),selectFirstItem:go("first",true),selectLastItem:go("last",true),toggleThisItem:toggleThis,toggleCurrent:toggleCurrent};obj.setController("keyboard",kb1);obj.setController("mouse",ms1);obj.setController("navigation",cur1);obj.setController("selection",{selectionModeChanged:function(mode){switch(mode){case "single":this.setController("keyboard",kb1);this.setController("mouse",ms1);break;case "multi":this.setController("keyboard",kb2);this.setController("mouse",ms2);break}}});function calcSelected(value,index){var i,a=this.getSelectedItems();for(i=0;i<a.length;i++){if(a[i]==index){if(!value){a=a.concat();a.splice(i,1);this.setSelectedItems(a)}return}}if(value){a=a.concat(index);this.setSelectedItems(a)}}obj.setController("selected",{itemSelectedChanged:calcSelected});function syncState(items2){var items1=this.getSelectedItems();this.timeout(function(){var i,r1={},r2={};for(i=0;i<items1.length;i++){r1[items1[i]]=true}for(i=0;i<items2.length;i++){r2[items2[i]]=true}for(i=0;i<items1.length;i++){if(!r2[items1[i]] && this.getItemSelected(items1[i])){this.setItemSelected(false,items1[i])}}for(i=0;i<items2.length;i++){if(!r1[items2[i]] && !this.getItemSelected(items2[i])){this.setItemSelected(true,items2[i])}}},0)}obj.setController("state",{currentItemChanging:updateCurrent,selectedItemsChanging:syncState,itemSelectedChanged:"calculateItemState"});function updateCurrent(i2){var i1=this.getCurrentItem();this.timeout(function(){this.action("calculateItemState",0,i2);var e2=this.getItemTemplate(i2).getContent("box/text").element();if(e2){e2.tabIndex=this.getTabIndex();e2.focus()}this.action("calculateItemState",0,i1);var e1=this.getItemTemplate(i1).getContent("box/text").element();if(e1 && i1 !=i2){e1.tabIndex=-1}},0)}obj.onCalculateItemState=function(v,i){var state="";if(this.getCurrentItem()==i){state="current"}if(this.getItemSelected(i)){state="selected"}this.setItemState(state,i)}};
 AW.UI.Tabs=AW.UI.List.subclass();AW.UI.Tabs.create=function(){var obj=this.prototype;obj.setClass("ui","tabs");obj.setClass("text","expand");obj.setClass("flow","horizontal")};
 AW.UI.Combo=AW.UI.List.subclass();AW.UI.Combo.create=function(){AW.UI.ImageText.create.call(this);AW.UI.Input.create.call(this);var obj=this.prototype;obj.setAttribute("aw","combo");obj.setClass("ui","combo");obj.setClass("text","");obj.setContent("html","");obj.defineTemplate("popup",new AW.Templates.Popup);var button=new AW.HTML.TABLE;button.setClass("item","combo");button.setAttribute("cellspacing","0");button.setEvent("onclick",function(){this.getPopupTemplate().show()});obj.setContent("box/sign",button);obj.setContent("box/sign/html","<tr class=\"aw-cb-1\"><td></td></tr><tr class=\"aw-cb-2\"><td>&nbsp;</td></tr><tr class=\"aw-cb-3\"><td></td></tr>");obj.onCurrentItemChanged=function(i){var text=this.getItemText(i);this.setControlText(text);this.timeout(function(){this.getPopupTemplate().hide();this.getContent("box/text").element().value=text;this.onKeyEnter()},100)}};
 AW.UI.CheckBox=AW.UI.ImageText.subclass();AW.UI.CheckBox.create=function(){AW.Templates.CheckBox.create.call(this);var obj=this.prototype;obj.setClass("ui","checkbox");obj.setControlProperty("value",false)};AW.UI.Checkbox=AW.UI.CheckBox;
 AW.UI.CheckedList=AW.UI.List.subclass();AW.UI.CheckedList.create=function(){var obj=this.prototype;obj.setClass("ui","checkedlist");obj.setItemTemplate(new AW.Templates.CheckedItem);var kb={keyHome:"gotoFirstItem",keyEnd:"gotoLastItem",keyUp:"gotoPreviousItem",keyDown:"gotoNextItem",keyPageUp:"gotoPreviousPage",keyPageDown:"gotoNextPage",keySpace:"toggleCurrent"};var ms={itemClicked:"gotoThisItem"};obj.setController("keyboard",kb);obj.setController("mouse",ms)};
 AW.UI.Radio=AW.UI.CheckedList.subclass();AW.UI.Radio.create=function(){var obj=this.prototype;obj.setClass("ui","radio");obj.setItemTemplate(new AW.Templates.Radio);obj.setSelectionMode("single")};
 AW.Grid.Controllers.Size=(function(){function init(){this._rowHeight=this.getContent("sample").element().offsetHeight;if(!this._columnWidth1){this._columnWidth1=[]}var i,ii,n=this.getColumnCount(),a=this.getColumnIndices();for(i=0;i<n;i++){ii=a?a[i]:i;this._columnWidth1[ii]=this.getHeaderTemplate(ii).element().offsetWidth}var lw=0,lc=this.$extended?this.getFixedLeft():0;var mw=0,c=this.getColumnCount();var rw=0,rc=this.$extended?this.getFixedRight():0;lw=this.getSelectorVisible()?this.getSelectorWidth():lw;if(!this.$extended){mw=lw;lw=0}for(i=0;i<lc;i++){lw+=this.getColumnWidth(a?a[i]:i)}for(i=c-rc;i<c;i++){rw+=this.getColumnWidth(a?a[i]:i)}this.setContentWidth(lw,0);this.setContentWidth(rw,2)}function footer(){var i,h=0,count=this.$extended?this.getFooterCount():1,a=this.getFooterIndices();if(this.getFooterVisible()){for(i=0;i<count;i++){h+=this.getFooterHeight(a?a[i]:i)}}this.setContentHeight(h,2)}function header(){var i,h=0,count=this.$extended?this.getHeaderCount():1,a=this.getHeaderIndices();if(this.getHeaderVisible()){for(i=0;i<count;i++){h+=this.getHeaderHeight(a?a[i]:i)}}this.setContentHeight(h,0)}return{headerVisibleChanged:header,headerHeightChanged:header,headerCountChanged:header,footerVisibleChanged:footer,footerHeightChanged:footer,footerCountChanged:footer,paint:init}})();
 AW.Grid.Controllers.Cell=(function(){function refresh(value,col,row){this.getCellTemplate(col,row).refresh()}function refreshClasses(value,col,row){this.getCellTemplate(col,row).refreshClasses()}function edit(){var i=this.getCurrentColumn();var j=this.getCurrentRow();if(!this.getCellEditable(i,j)){return}var editor=this.getEditorTemplate(i,j);var cell=this.getCellTemplate(i,j);if(cell.element()){cell.element().outerHTML=editor;this.$edit=true;this.timeout(function(){var text=editor.element().getElementsByTagName("input")[0];text.focus();text.select();text=null})}}function update(text,i,j){var cell=this.getCellTemplate(i,j);var editor=this.getEditorTemplate(i,j);if(editor.element()){editor.element().outerHTML=cell}this.timeout(function(){this.element().focus()});this.$edit=false}function checkUpdate(v,i,j){if(this.$edit){update.call(this,v,i,j)}}function cellData(val,col,row){function dataToText(i,j){var data=this.getCellData(i,j);var format=this.getCellFormat(i,j);return format?format.dataToText(data):data}function dataToValue(i,j){var data=this.getCellData(i,j);var format=this.getCellFormat(i,j);return format?format.dataToValue(data):data}this.setCellText(dataToText,col,row);this.setCellValue(dataToValue,col,row)}return{editCurrentCell:edit,update:update,cellSelectedChanging:checkUpdate,cellSelectedChanged:"calculateCellState",cellDataChanged:cellData,cellTextChanged:refresh,cellImageChanged:refresh,cellValueChanged:refresh,cellStateChanged:refreshClasses}})();
 AW.Grid.Controllers.Row=(function(){function refresh(value,row){this.getRowTemplate(row).refreshClasses()}return{rowSelectedChanged:"calculateRowState",rowStateChanged:refresh}})();
 AW.Grid.Controllers.View={rowIndicesChanged:function(indices){var positions=[];for(var i=0;i<indices.length;i++){positions[indices[i]]=i}this.setRowPosition(positions);this.refresh()},columnIndicesChanged:function(indices){var positions=[];for(var i=0;i<indices.length;i++){positions[indices[i]]=i}this.setColumnPosition(positions);this.setColumnCount(indices.length);this.refresh()}};
 AW.Grid.Controllers.Navigation=(function(){function sync(){var mode=this.getCurrentSelection();var c1=this.getSelectedColumns();var r1=this.getSelectedRows();if(mode=="cell"){this.timeout(function(){var c2=this.getSelectedColumns();var r2=this.getSelectedRows();var i,j,x1={},x2={};for(i=0;i<c1.length;i++){x1[c1[i]]={};for(j=0;j<r1.length;j++){x1[c1[i]][r1[j]]=true}}for(i=0;i<c2.length;i++){x2[c2[i]]={};for(j=0;j<r2.length;j++){x2[c2[i]][r2[j]]=true}}for(i=0;i<c1.length;i++){for(j=0;j<r1.length;j++){if((!x2[c1[i]] || !x2[c1[i]][r1[j]])&& this.getCellSelected(c1[i],r1[j])){this.setCellSelected(false,c1[i],r1[j])}}}for(i=0;i<c2.length;i++){for(j=0;j<r2.length;j++){if((!x1[c2[i]] || !x1[c2[i]][r2[j]])&& !this.getCellSelected(c2[i],r2[j])){this.setCellSelected(true,c2[i],r2[j])}}}},0)}else if(mode=="row"){this.timeout(function(){var r2=this.getSelectedRows();var i,x1={},x2={};for(i=0;i<r1.length;i++){x1[r1[i]]=true}for(i=0;i<r2.length;i++){x2[r2[i]]=true}for(i=0;i<r1.length;i++){if(!x2[r1[i]] && this.getRowSelected(r1[i])){this.setRowSelected(false,r1[i])}}for(i=0;i<r2.length;i++){if(!x1[r2[i]] && !this.getRowSelected(r2[i])){this.setRowSelected(true,r2[i])}}},0)}}function syncRows(value,index){var i,a=this.getSelectedRows();for(i=0;i<a.length;i++){if(a[i]==index){if(!value){a=a.concat();a.splice(i,1);this.setSelectedRows(a)}return}}if(value){a=a.concat(index);this.setSelectedRows(a)}}function row(dir,select){return function(event,i){i=(dir=="this")?i:this.getCurrentRow();var k;switch(dir){case "previous":i=this.getRowPrevious(i);break;case "next":i=this.getRowNext(i);break;case "first":i=this.getRowFirst();break;case "last":i=this.getRowLast();break;case "pageup":for(k=0;k<10;k++){i=this.getRowPrevious(i)}break;case "pagedown":for(k=0;k<10;k++){i=this.getRowNext(i)}break}this.setCurrentRow(i);if(select){this.setSelectedRows([i])}AW.setReturnValue(event,false)}}function cell(dir,select){return function(event,i,j){i=(dir=="this")?i:this.getCurrentColumn();j=(dir=="this")?j:this.getCurrentRow();var k;switch(dir){case "next":i=this.getColumnNext(i);break;case "previous":i=this.getColumnPrevious(i);break;case "first":i=this.getColumnFirst();break;case "last":i=this.getColumnLast();break;case "up":j=this.getRowPrevious(j);break;case "down":j=this.getRowNext(j);break;case "top":j=this.getRowFirst();break;case "bottom":j=this.getRowLast();break;case "pageup":for(k=0;k<10;k++){j=this.getRowPrevious(j)}break;case "pagedown":for(k=0;k<10;k++){j=this.getRowNext(j)}break;case "home":i=this.getColumnFirst();j=this.getRowFirst();break;case "end":i=this.getColumnLast();j=this.getRowLast();break}this.setCurrentColumn(i);this.setCurrentRow(j);if(select){this.setSelectedColumns([i]);this.setSelectedRows([j])}if(dir !="this"){AW.setReturnValue(event,false)}}}return{gotoThisRow:row("this"),gotoPreviousRow:row("previous"),gotoNextRow:row("next"),gotoFirstRow:row("first"),gotoLastRow:row("last"),gotoPageUpRow:row("pageup"),gotoPageDownRow:row("pagedown"),selectThisRow:row("this",true),selectPreviousRow:row("previous",true),selectNextRow:row("next",true),selectFirstRow:row("first",true),selectLastRow:row("last",true),selectPageUpRow:row("pageup",true),selectPageDownRow:row("pagedown",true),selectThisCell:cell("this",true),selectUpperCell:cell("up",true),selectLowerCell:cell("down",true),selectTopCell:cell("top",true),selectBottomCell:cell("bottom",true),selectPreviousCell:cell("previous",true),selectNextCell:cell("next",true),selectFirstCell:cell("first",true),selectLastCell:cell("last",true),selectTopLeftCell:cell("home",true),selectBottomRightCell:cell("end",true),selectPageUpCell:cell("pageup",true),selectPageDownCell:cell("pagedown",true),selectedColumnsChanging:sync,selectedRowsChanging:sync,rowSelectedChanged:syncRows,selectionModeChanged:function(mode){switch(mode){case "single-cell":this.setController("selection",AW.Grid.Controllers.SingleCell);this.setCurrentSelection("cell");break;case "single-row":this.setController("selection",AW.Grid.Controllers.SingleRow);this.setCurrentSelection("row");break;case "multi-row-marker":this.setController("selection",AW.Grid.Controllers.MultiRowMarker);this.setCurrentSelection("row");var checkbox=new AW.Templates.CheckedItem;this.setCellTemplate(checkbox,0);break}}}})();
 AW.Grid.Controllers.Sort={sort:function(src,index,header){if(!(header=="0" || typeof(header)=="undefined")){return}function compare(value,pos,dir){var greater=1,less=-1;if(dir=="descending"){greater=-1;less=1}var types={"undefined":0,"boolean":1,"number":2,"string":3,"object":4,"function":5};return function(i,j){var a=value[i],b=value[j],x,y;if(typeof(a)!=typeof(b)){x=types[typeof(a)];y=types[typeof(b)];if(x > y){return greater}if(x < y){return less}}else if(typeof(a)=="number"){if(a > b){return greater}if(a < b){return less}}else{var result=(""+a).localeCompare(b);if(result){return greater * result}}x=pos[i];y=pos[j];if(x > y){return 1}if(x < y){return -1}return 0}}var direction=this.getSortDirection(index);if(direction !="ascending"){direction="ascending"}else{direction="descending"}if(src=="ascending" || src=="descending"){direction=src}var i,value={},pos={};var offset=this.getRowOffset();var count=this.getRowCount();var rows=this.getRowIndices();if(offset){}if(!rows){rows=[];for(i=0;i<count;i++){rows[i]=i+offset}}else{rows=rows.slice(offset,offset+count)}for(i=0;i<rows.length;i++){value[rows[i]]=this.getCellValue(index,rows[i]);pos[rows[i]]=i}rows.sort(compare(value,pos,direction));var a=[];for(i=0;i<offset;i++){a[i]=i}rows=a.concat(rows);var old=this.getSortColumn();if(old !=-1){this.setSortDirection("",old)}this.setSortColumn(index);this.setSortDirection(direction,index);this.setRowIndices(rows)},headerClicked:"sort"};
 AW.Grid.Controllers.Overflow={scrollLeftChanged:function(x){var e=this.getScrollTemplate().element();if(e){e.firstChild.scrollLeft=x}},scrollTopChanged:function(y){var e=this.getScrollTemplate().element();if(e){e.firstChild.scrollTop=y}},scrollWidthChanged:function(w){var e=this.getScrollTemplate().element();if(e){e.firstChild.firstChild.style.width=w+"px"}},scrollHeightChanged:function(h){var e=this.getScrollTemplate().element();if(e){e.firstChild.firstChild.style.height=h+"px"}},scrollBarsChanged:function(x){this.getScrollTemplate().refreshClasses()},adjustScrollBars:function(){var e=this.getScrollTemplate().element();if(!e){return}var s,x,y;var l=this.getScrollLeft();var t=this.getScrollTop();var w=this.getScrollWidth();var h=this.getScrollHeight();var ww=e.offsetWidth;var hh=e.offsetHeight;if(w < ww && h < hh){s="none";x=0;y=0}else if(w < ww - 16){s="vertical";x=20;y=0}else if(h < hh - 16){s="horizontal";x=0;y=20}else{s="both";x=20;y=20}if(this.getScrollBars()!=s){this.setScrollBars(s)}if(w - l < ww - x){var ll=Math.max(0,w - ww+x);if(ll !=l){this.setScrollLeft(ll)}}if(h - t < hh - y){var tt=Math.max(0,h - hh+y);if(tt !=t){this.setScrollTop(tt)}}this.setContentHeight(hh - y - this.getContentHeight(0)- this.getContentHeight(2),1);this.setContentWidth(ww - x - this.getContentWidth(0)- this.getContentWidth(2),1)},columnWidthChanged:function(){var i,a=this.getColumnIndices();var lw=0,lc=this.$extended?this.getFixedLeft():0;var mw=0,c=this.getColumnCount();var rw=0,rc=this.$extended?this.getFixedRight():0;lw=this.getSelectorVisible()?this.getSelectorWidth():lw;if(!this.$extended){mw=lw;lw=0}for(i=0;i<lc;i++){lw+=this.getColumnWidth(a?a[i]:i)}for(i=c-rc;i<c;i++){rw+=this.getColumnWidth(a?a[i]:i)}this.setContentWidth(lw,0);this.setContentWidth(rw,2)},paint:function(){var x=this.getScrollLeft();var y=this.getScrollTop();this.action("adjustScrollWidth");this.action("adjustScrollHeight");if(x){this.action("scrollLeftChanged",x)}if(y){this.action("scrollTopChanged",y)}this.action("adjustScrollBars");if(x){this.timeout(function(){this.action("scrollLeftChanged",x)})}if(y){this.timeout(function(){this.action("scrollTopChanged",y)})}}};
 AW.Grid.Controllers.Scroll={scrollLeftChanged:function(x){var e1=this.getRowsTemplate().element();var e2=this.getHeadersTemplate().element();var e3=this.getFootersTemplate().element();if(e1){e1.parentNode.scrollLeft=x}if(e2){e2.parentNode.scrollLeft=x}if(e3){e3.parentNode.scrollLeft=x}},scrollTopChanged:function(y){var e=this.getRowsTemplate().element();if(e){e.parentNode.scrollTop=y}},adjustScrollWidth:function(){var a=this.getColumnIndices();var c=this.getColumnCount();var w=this.getSelectorVisible()?this.getSelectorWidth():0;for(var i=0;i<c;i++){w+=this.getColumnWidth(a?a[i]:i)}this.setScrollWidth(w+3)},adjustScrollHeight:function(){var h=this.getRowCount()* this.getRowHeight();h+=this.getContentHeight(0);h+=this.getContentHeight(2);this.setScrollHeight(h+3)}};
 AW.Grid.Controllers.Width={columnWidthChanged:function(width,column){try{if(this.element()){if(AW.browser=="ie"){}this.action2("adjustScrollWidth");this.action2("adjustScrollBars")}var w=width - AW.dx,c=column;var i,ss=document.styleSheets[document.styleSheets.length-1];var selector="#"+this.getId()+" .aw-column-"+c;var rules=AW.getRules(ss);for(i=0;i<rules.length;i++){if(rules[i].selectorText==selector){rules[i].style.width=w;return}}AW.addRule(ss,selector,"width:"+w+"px")}catch(r){}},selectorWidthChanged:function(width){try{if(this.element()){this._blockMouse(2000);this.action2("adjustScrollWidth");this.action2("adjustScrollBars")}var w=width - AW.dx;var i,ss=document.styleSheets[document.styleSheets.length-1];var selector="#"+this.getId()+" .aw-row-selector";var rules=AW.getRules(ss);for(i=0;i<rules.length;i++){if(rules[i].selectorText==selector){rules[i].style.width=w;return}}AW.addRule(ss,selector,"width:"+w+"px")}catch(r){}},rowHeightChanged:function(height){try{if(this.element()){this.action2("adjustScrollHeight");this.action2("adjustScrollBars")}var h=height - AW.dy;var i,ss=document.styleSheets[document.styleSheets.length-1];var selector="#"+this.getId()+" .aw-grid-row";var rules=AW.getRules(ss);for(i=0;i<rules.length;i++){if(rules[i].selectorText==selector){rules[i].style.height=h;return}}AW.addRule(ss,selector,"height:"+h+"px")}catch(r){}}};
 AW.Grid.Controllers.Virtual=(function(){var serial=0;function virtual(){var s=++serial;this.timeout(function(){var i=0,ii,a=[];var count=this.getRowProperty("count");var offset=this.getRowProperty("offset");var indices=this.getRowProperty("indices");var scroll=this.getScrollProperty("top");var row=this.getRowProperty("height");var top=Math.floor(scroll/row);var dir=this.getVirtualTop()> top?"back":"forward";this.setVirtualTop(top);var client=Math.floor(this.getContentHeight(1)/row);if(!client){client=40}var x1=Math.min(count,Math.max(0,top - 20));var x2=Math.min(count,top);var x3=Math.min(count,top+client);var x4=Math.min(count,top+client+20);function r1(){if(s !=serial){return}if(i1 < x4){ii=indices?indices[i1+offset]:i1+offset;this.getRowTemplate(ii).refresh();i1++;this.timeout(r1)}else if(dir=="forward"){this.timeout(r2)}}function r2(){if(s !=serial){return}if(i2 >=x1){ii=indices?indices[i2+offset]:i2+offset;this.getRowTemplate(ii).refresh();i2--;this.timeout(r2)}else if(dir=="back"){this.timeout(r1)}}i1=x3;i2=x2-1;if(dir=="forward"){r1.call(this)}else{r2.call(this)}})}return{currentRowChanged:function(i){var scroll=this.getScrollProperty("top");var height=this.getRowProperty("height");var top=(this.getRowPosition(i)-this.getRowOffset())* height;if(top < scroll){this.timeout(function(){this.setScrollTop(top)})}var max=this.getContentHeight(1);var bottom=top+height;if(max+scroll < bottom){this.timeout(function(){this.setScrollTop(bottom - max)})}},currentColumnChanged:function(index){var scroll=this.getScrollProperty("left");var col=this.getColumnPosition(index);var i,a=this.getColumnIndices();var lw=0,lc=this.$extended?this.getFixedLeft():0;var mw=0,c=this.getColumnCount();var rw=0,rc=this.$extended?this.getFixedRight():0;lw=this.getSelectorVisible()?this.getSelectorWidth():lw;if(!this.$extended){mw=lw;lw=0}for(i=0;i<lc;i++){lw+=this.getColumnWidth(a?a[i]:i)}for(i=lc;i<Math.min(col,c-rc-1);i++){mw+=this.getColumnWidth(a?a[i]:i)}for(i=c-rc;i<c;i++){rw+=this.getColumnWidth(a?a[i]:i)}if(!col){mw=0}if(mw < scroll){this.timeout(function(){this.setScrollLeft(mw)});return}var max=this.getContentWidth(1);var right=mw+this.getColumnWidth(index);if(max+scroll < right){this.timeout(function(){this.setScrollLeft(right - max)})}},scrollTopChanging:function(scroll){if(!this.getVirtualMode()|| this.getScrollTop()==scroll){return}var s=++serial;var row=this.getRowHeight();var top=Math.floor(scroll/row);if(Math.abs(top - this.getVirtualTop())< 6){this.timeout(refreshRows,1000);return}function refreshRows(){if(s !=serial){return}this.getRowsTemplate().refresh();virtual.call(this)}this.timeout(refreshRows,200)},paint:function(){if(!this.getVirtualMode()){return}virtual.call(this)}}})();
 AW.Grid.Controllers.Grid={rowsTemplateChanged:function(rows){rows.mapTemplate("item","row");rows.mapModel("view","row")},rowTemplateChanged:function(row){row.setAttribute("aw","row");row.setClass("grid","row");row.setClass("row",function(){return this.$0});row.setClass("rows",function(){return this.getRowProperty("state")|| "normal"});row.setClass("alternate",function(){return this.getRowProperty("position")% 2?"odd":"even"});row.mapTemplate("item",function(i){return this.$owner.getCellTemplate(i,this.$0)});row.mapTemplate("selector",function(){return this.$owner.getSelectorTemplate(this.$0)});row.mapModel("view","column")},cellTemplateChanged:function(cell){cell.setAttribute("aw","cell");cell.setClass("grid","cell");cell.setClass("column",function(){return this.$0});cell.setClass("cells",function(){return this.getControlProperty("state")|| "normal"});cell.mapModel("control","cell");cell.getStateProperty=function(p){return this.$owner.getRowProperty(p,this.$1)};cell.setStateProperty=function(p,v){this.$owner.setRowProperty(p,v,this.$1)}},editorTemplateChanged:function(editor){editor.setClass("grid","cell");editor.setClass("column",function(){return this.$0});editor.mapModel("control","cell")},headersTemplateChanged:function(headers){headers.setClass("grid","headers");headers.setClass("header",function(){return this.$0 || "0"});headers.setStyle("height",function(){return this.getHeaderProperty("height")- AW.dy+"px"});headers.getContent("end").setClass("grid","header");headers.mapTemplate("item",function(i){return this.$owner.getHeaderTemplate(i,this.$0)+this.$owner.getSeparatorTemplate(i,this.$0)});headers.mapTemplate("selector",function(){return this.$owner.getTopSelectorTemplate(this.$0)+(this.$owner.getSelectorResizable()&& !this.$0?this.$owner.getSeparatorTemplate():"")});headers.mapModel("view","column")},footersTemplateChanged:function(footers){footers.setClass("grid","footers");footers.setClass("footer",function(){return this.$0 || "0"});footers.setStyle("height",function(){return this.getFooterProperty("height")- AW.dy+"px"});footers.mapTemplate("item",function(i){return this.$owner.getFooterTemplate(i,this.$0)});footers.mapTemplate("selector","bottomSelector");footers.mapModel("view","column")},headerTemplateChanged:function(header){header.setAttribute("aw","header");header.setClass("grid","header");header.setClass("column",function(){return this.$0});header.mapModel("control","header");header.getStateProperty=function(p){return this.$owner.getColumnProperty(p,this.$0)};header.setStateProperty=function(p,v){this.$owner.setColumnProperty(p,v,this.$0)}},footerTemplateChanged:function(footer){footer.setAttribute("aw","footer");footer.setClass("grid","footer");footer.setClass("column",function(){return this.$0});footer.mapModel("control","footer")},selectorTemplateChanged:function(selector){selector.setAttribute("aw","selector");selector.setClass("row","selector");selector.mapModel("control","selector");selector.mapModel("state","row")},topSelectorTemplateChanged:function(selector){selector.setAttribute("aw","topSelector");selector.setClass("grid","header");selector.setClass("row","selector");selector.mapModel("control","top")},bottomSelectorTemplateChanged:function(selector){selector.setAttribute("aw","bottomSelector");selector.setClass("row","selector");selector.mapModel("control","bottom")},contentTemplateChanged:function(content){content.mapModel("panel","content");content.mapTemplate("panel",function(i){switch(i){case 0:return this.getHeadersTemplate();case 1:return this.getRowsTemplate();case 2:return this.getFootersTemplate()}})}};
 AW.Grid.Controllers.Extended={contentTemplateChanged:function(content){content.mapModel("panel","content");content.mapTemplate("panel",function(i,j){switch(i){case 0:return this.$owner.getTopTemplate(j);case 1:return this.$owner.getRowsTemplate(j);case 2:return this.$owner.getBottomTemplate(j)}})},topTemplateChanged:function(top){top.mapTemplate("item","headers");top.mapModel("view","header")},bottomTemplateChanged:function(bottom){bottom.mapTemplate("item","footers");bottom.mapModel("view","footer")}};
 AW.Grid.Controllers.SingleCell={keyUp:"selectUpperCell",keyDown:"selectLowerCell",keyCtrlUp:"selectTopCell",keyCtrlDown:"selectBottomCell",keyLeft:"selectPreviousCell",keyRight:"selectNextCell",keyHome:"selectFirstCell",keyEnd:"selectLastCell",keyCtrlHome:"selectTopLeftCell",keyCtrlEnd:"selectBottomRightCell",keyPageUp:"selectPageUpCell",keyPageDown:"selectPageDownCell",keyF2:"editCurrentCell",keyEnter:"editCurrentCell",cellMouseDown:"selectThisCell",cellDoubleClicked:"editCurrentCell"};
 AW.Grid.Controllers.SingleRow={keyUp:"selectPreviousRow",keyDown:"selectNextRow",keyHome:"selectFirstRow",keyEnd:"selectLastRow",keyPageUp:"selectPageUpRow",keyPageDown:"selectPageDownRow",rowMouseDown:"selectThisRow"};
 AW.Grid.Controllers.MultiRowMarker={keyUp:"gotoPreviousRow",keyDown:"gotoNextRow",keyHome:"gotoFirstRow",keyEnd:"gotoLastRow",keyPageUp:"gotoPageUpRow",keyPageDown:"gotoPageDownRow",rowSelectedChanged:function(v,i){this.getRowTemplate(i).refresh()}};
 AW.Grid.Separator=AW.System.Template.subclass();AW.Grid.Separator.create=function(){var obj=this.prototype;obj.setClass("grid","separator");obj.setEvent("onmousedown",function(event){var start=event.clientX;var self=this;var width=self.element().previousSibling.offsetWidth;function doResize(event){var w=width+event.clientX - start;w=w > 9?w:9;self.element().previousSibling.style.width=w - AW.dx}function endResize(event){var w=width+event.clientX - start;w=w > 9?w:9;var e=self.element();AW.detachEvent(e,"onmousemove",doResize);AW.detachEvent(e,"onmouseup",endResize);AW.detachEvent(e,"onlosecapture",endResize);AW.releaseCapture(e);var id=e.previousSibling.id;if(id.match("header")){self.$owner.setColumnProperty("width",w,self.$0)}else if(id.match("topSelector")){self.$owner.setSelectorProperty("width",w)}e.previousSibling.style.width="";e=null}var e=AW.srcElement(event);AW.attachEvent(e,"onmousemove",doResize);AW.attachEvent(e,"onmouseup",endResize);AW.attachEvent(e,"onlosecapture",endResize);AW.setCapture(e);e=null;event.cancelBubble=true})};
 AW.Grid.Header=AW.Templates.ImageText.subclass();AW.Grid.Header.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;function _direction(){return this.getSortProperty("direction")|| "none"}var sort=new AW.HTML.SPAN;sort.setClass("grid","sort");sort.setClass("sort",_direction);obj.setContent("box/text/sort",sort);obj.element=function(){if(typeof(this.$1)=="undefined" && this.$owner.$extended){return _super.element.call(this.$owner.getHeaderTemplate(this.$0,0))}else{return _super.element.call(this)}}};
 AW.Grid.Row=AW.Templates.List.subclass();AW.Grid.Row.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.setClass("text","normal");var span=AW.HTML.SPAN;var space=new span;var box=new span;space.setClass("item","template");space.setClass("grid","cell");space.setClass("column","space");box.setClass("item","box");space.setContent("box",box);obj.setContent("end",space);obj.setContent("start",function(){return this.getSelectorProperty("visible")&& !this.$1?this.getSelectorTemplate():""});var items=obj.getContent("items");obj.setContent("items",function(){return this.$name=="row" && this.$owner._fast?"":items.call(this)});var refresh=obj.refresh;obj.refresh=function(){if(typeof(this.$1)=="undefined" && this.$owner.$extended){for(var i=0;i<3;i++){refresh.call(this.$owner.getRowTemplate(this.$0,i))}}else{refresh.call(this)}};var refreshClasses=obj.refreshClasses;obj.refreshClasses=function(){if(typeof(this.$1)=="undefined" && this.$owner.$extended){for(var i=0;i<3;i++){refreshClasses.call(this.$owner.getRowTemplate(this.$0,i))}}else{refreshClasses.call(this)}}};
 AW.Grid.Rows=AW.Templates.List.subclass();AW.Grid.Rows.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.setClass("grid","view");obj.setContent("items",function(){var i,ii,a=[];var count=this.getViewProperty("count");var offset=this.getViewProperty("offset");var indices=this.getViewProperty("indices");var virtual=this.getVirtualProperty("mode");if(!virtual){for(i=0;i<count;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getItemTemplate(ii).toString()}}else{var scroll=this.getScrollProperty("top");var height=this.getRowProperty("height");var top=Math.floor(scroll/height);var e=this.$owner.element();var client;if(e){client=Math.floor(e.offsetHeight/height)}e=null;if(!client){client=40}var x1=Math.min(count,Math.max(0,top - 50));var x2=Math.min(count,top);var x3=Math.min(count,top+client);var x4=Math.min(count,top+client+50);this.$owner._fast=true;for(i=x1;i<x2;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getItemTemplate(ii).toString()}this.$owner._fast=false;for(i=x2;i<x3;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getItemTemplate(ii).toString()}this.$owner._fast=true;for(i=x3;i<x4;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getItemTemplate(ii).toString()}this.$owner._fast=false}return a.join("")});var span=AW.HTML.SPAN;var top=new span;top.setClass("view","top");top.setStyle("height",function(){var virtual=this.getVirtualProperty("mode");if(!virtual){return 0}var scroll=this.getScrollProperty("top");var height=this.getRowProperty("height");var offset=Math.max(0,Math.floor(scroll/height)-50)* height;return offset+"px"});obj.setContent("start",top);var space=new span;var box=new span;space.setClass("item","template");space.setClass("row","selector");space.setClass("selector","space");box.setClass("item","box");space.setContent("box",box);obj.setContent("end",space);obj.refresh=function(){if(typeof(this.$0)=="undefined" && this.$owner.$extended){for(var i=0;i<3;i++){_super.refresh.call(this.$owner.getRowsTemplate(i))}}else{_super.refresh.call(this)}}};
 AW.Grid.Control=AW.System.Control.subclass();AW.Grid.Control.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.setClass("grid","control");obj.setClass("selectors",function(){return this.getSelectorVisible()?"visible":"hidden"});var sample=new AW.HTML.SPAN;sample.setClass("row","sample");sample.setClass("grid","row");obj.setContent("sample",sample);var box=new AW.HTML.SPAN;box.setClass("grid","box");box.setContent("html",function(){return this.getLayoutTemplate()});obj.setContent("box",box);var GC=AW.Grid.Controllers;obj.setController("size",GC.Size);obj.setController("cell",GC.Cell);obj.setController("row",GC.Row);obj.setController("view",GC.View);obj.setController("navigation",GC.Navigation);obj.setController("selection",GC.SingleCell);obj.setController("sort",GC.Sort);obj.setController("overflow",GC.Overflow);obj.setController("scroll",GC.Scroll);obj.setController("width",GC.Width);obj.setController("virtual",GC.Virtual);obj.setController("grid",GC.Grid);obj.defineTemplate("layout",function(){return this.getScrollTemplate()});obj.defineTemplate("scroll",new AW.Scroll.Bars);obj.defineTemplate("content",new AW.Panels.Horizontal);obj.defineTemplate("panel",function(){return ""});obj.defineTemplate("rows",new AW.Grid.Rows);obj.defineTemplate("row",new AW.Grid.Row);obj.defineTemplate("cell",new AW.Templates.Text);obj.defineTemplate("headers",new AW.Grid.Row);obj.defineTemplate("footers",new AW.Grid.Row);obj.defineTemplate("header",new AW.Grid.Header);obj.defineTemplate("footer",new AW.Templates.ImageText);obj.defineTemplate("separator",new AW.Grid.Separator);obj.defineTemplate("editor",new AW.UI.Input);obj.defineTemplate("selector",new AW.Templates.ImageText);obj.defineTemplate("topSelector",new AW.Templates.ImageText);obj.defineTemplate("bottomSelector",new AW.Templates.ImageText);function rowNext(i){var p=Math.min(this.getRowPosition(i)+1,this.getRowOffset()+this.getRowCount()- 1);var a=this.getRowIndices();return a?a[p]:p}function rowPrevious(i){var p=Math.max(this.getRowPosition(i)- 1,this.getRowOffset());var a=this.getRowIndices();return a?a[p]:p}function rowFirst(){var p=this.getRowOffset();var a=this.getRowIndices();return a?a[p]:p}function rowLast(){var p=this.getRowOffset()+this.getRowCount()- 1;var a=this.getRowIndices();return a?a[p]:p}function columnNext(i){var p=Math.min(this.getColumnPosition(i)+1,this.getColumnOffset()+this.getColumnCount()- 1);var a=this.getColumnIndices();return a?a[p]:p}function columnPrevious(i){var p=Math.max(this.getColumnPosition(i)- 1,this.getColumnOffset());var a=this.getColumnIndices();return a?a[p]:p}function columnFirst(){var p=this.getColumnOffset();var a=this.getColumnIndices();return a?a[p]:p}function columnLast(){var p=this.getColumnOffset()+this.getColumnCount()- 1;var a=this.getColumnIndices();return a?a[p]:p}function cellValue(i,j){var text=this.getCellText(i,j);var format=this.getCellFormat(i,j);return format?format.textToValue(text):text}var scrollModel={left:0,top:0,width:0,height:0,bars:"both"};var cellModel={text:"",image:"",link:"",value:cellValue,data:"",format:"",tooltip:"",state:"",selected:false,editable:true};var columnModel={offset:0,count:0,position:function(i){return Number(i)},next:columnNext,previous:columnPrevious,first:columnFirst,last:columnLast,state:"",selected:false,resizable:true,width:100};var rowModel={offset:0,count:0,position:function(i){return Number(i)},next:rowNext,previous:rowPrevious,first:rowFirst,last:rowLast,state:"",selected:false,height:18};var currentModel={row:0,column:0,selection:"cell"};var selectedModel={};var selectionModel={mode:"rows",multiple:false};var sortModel={column:-1,direction:""};var headerModel={count:0,text:"",image:"",value:"",state:"",count:1,offset:0,height:20,visible:true};var selectorModel={text:"",image:"",value:"",state:"",width:20,resizable:false,visible:false};var topModel={text:"",image:"",value:"",state:""};var fixedModel={left:1,right:0};var virtualModel={mode:true,top:0};var contentModel={width:0,height:0};obj.defineModel("scroll",scrollModel);obj.defineModel("cell",cellModel);obj.defineModel("header",headerModel);obj.defineModel("footer",headerModel);obj.defineModel("selector",selectorModel);obj.defineModel("top",topModel);obj.defineModel("bottom",topModel);obj.defineModel("column",columnModel);obj.defineModel("row",rowModel);obj.defineModel("current",currentModel);obj.defineModel("selected",selectedModel);obj.defineModel("selection",selectionModel);obj.defineModel("sort",sortModel);obj.defineModel("virtual",virtualModel);obj.defineModel("content",contentModel);obj.defineModel("panel",contentModel);obj.defineModel("fixed",fixedModel);obj.defineColumnProperty("indices","",true);obj.defineRowProperty("indices","",true);obj.defineHeaderProperty("indices","",true);obj.defineFooterProperty("indices","",true);obj.defineSelectedProperty("rows",[],true);obj.defineSelectedProperty("columns",[],true);obj.setFooterVisible(false);obj.setContentWidth(100,0);obj.setContentHeight(20,0);obj.getCellEditor=obj.getEditorTemplate;obj.setCellEditor=obj.setEditorTemplate;obj.onCalculateRowState=function(v,i){var state="";if(this.getCurrentRow()==i){state="current"}if(this.getRowSelected(i)){state="selected"}this.setRowState(state,i)};obj.onCalculateCellState=function(v,i,j){var state="";if(this.getCurrentColumn()==i && this.getCurrentRow()==j){state="current"}if(this.getCellSelected(i,j)){state="selected"}this.setCellState(state,i,j)};if(AW.browser=="ie"){obj.setStyle("visibility","expression(AW.paint(this))")}if(AW.browser=="safari" || AW.browser=="opera"){obj.toString=function(){this.timeout(function(){this.action("paint")},3000);return _super.toString.call(this)}}obj.addRow=function(){alert("not implemented")};obj.deleteRow=function(){alert("not implemented")};obj.sort=function(column,direction){this.action("sort",direction,column)}};AW.UI.Grid=AW.Grid.Control;
 AW.Grid.Extended=AW.Grid.Control.subclass();AW.Grid.Extended.create=function(){var obj=this.prototype;obj.$extended=true;obj.setController("extended",AW.Grid.Controllers.Extended);obj.setContentTemplate(new AW.Panels.Grid);obj.defineTemplate("top",new AW.Templates.List);obj.defineTemplate("bottom",new AW.Templates.List);var splitColumns=function(p,j){var left=this.$owner._fixedLeft,right=this.$owner._fixedRight;var i=this.$1;switch(p){case "count":if(i===0){return left}if(i==1){return this.$owner.getColumnProperty("count")- left - right}if(i==2){return right}return 0;case "offset":if(i===0){return 0}if(i==1){return left}if(i==2){return this.$owner.getColumnProperty("count")- right}return 0;default:return this.$owner.getColumnProperty(p,j)}};obj.getHeadersTemplate().mapModel("view",splitColumns);obj.getFootersTemplate().mapModel("view",splitColumns);obj.getRowTemplate().mapModel("view",splitColumns);var scrollController={scrollLeftChanged:function(x){var e1=this.getRowsTemplate(1).element();var e2=this.getTopTemplate(1).element();var e3=this.getBottomTemplate(1).element();if(e1){e1.parentNode.scrollLeft=x}if(e2){e2.parentNode.scrollLeft=x}if(e3){e3.parentNode.scrollLeft=x}},scrollTopChanged:function(y){var e1=this.getRowsTemplate(1).element();var e2=this.getRowsTemplate(0).element();var e3=this.getRowsTemplate(2).element();if(e1){e1.parentNode.scrollTop=y}if(e2){e2.parentNode.scrollTop=y}if(e3){e3.parentNode.scrollTop=y}},adjustScrollWidth:function(){var i,a=this.getColumnIndices();var lw=0,lc=this.getFixedLeft();var mw=0,c=this.getColumnCount();var rw=0,rc=this.getFixedRight();lw=this.getSelectorVisible()?this.getSelectorWidth():lw;for(i=0;i<lc;i++){lw+=this.getColumnWidth(a?a[i]:i)}for(i=lc;i<c-rc;i++){mw+=this.getColumnWidth(a?a[i]:i)}for(i=c-rc;i<c;i++){rw+=this.getColumnWidth(a?a[i]:i)}this.setScrollWidth(lw+mw+rw+3);var e1=this.getRowsTemplate(0).element();var e2=this.getTopTemplate(0).element();var e3=this.getBottomTemplate(0).element();if(e1){e1.parentNode.style.width=lw;e1.parentNode.parentNode.style.paddingLeft=lw}if(e2){e2.parentNode.style.width=lw;e2.parentNode.parentNode.style.paddingLeft=lw}if(e3){e3.parentNode.style.width=lw;e3.parentNode.parentNode.style.paddingLeft=lw}e1=this.getRowsTemplate(2).element();e2=this.getTopTemplate(2).element();e3=this.getBottomTemplate(2).element();if(e1){e1.parentNode.style.width=rw;e1.parentNode.parentNode.style.paddingRight=rw}if(e2){e2.parentNode.style.width=rw;e2.parentNode.parentNode.style.paddingRight=rw}if(e3){e3.parentNode.style.width=rw;e3.parentNode.parentNode.style.paddingRight=rw}},adjustScrollHeight:function(){var h=this.getRowCount()* this.getRowHeight();h+=this.getContentHeight(0);h+=this.getContentHeight(2);this.setScrollHeight(h+3)}};obj.setController("scroll",scrollController)};
 AW.Tree.Item=AW.Templates.ImageText.subclass();AW.Tree.Item.create=function(){var obj=this.prototype;obj.setClass("tree",function(){return this.getViewProperty("count")?"folder":"leaf"});obj.setClass("expanded",function(){return this.getViewProperty("expanded")?"true":"false"});var sign=new AW.HTML.SPAN;sign.setClass("tree","sign");sign.setEvent("onclick",function(){this.action("treeSignClicked")});obj.setContent("box/sign",sign)};
 AW.Tree.View=AW.System.Template.subclass();AW.Tree.View.create=function(){var obj=this.prototype;obj.setTag("span");obj.setClass("tree","view");obj.setContent("start",function(){return this.$0?this.getItemTemplate():""});obj.setContent("items",function(){if(this.$0 && !this.getViewProperty("expanded")){return ""}var i,ii,a=[];var count=this.getViewProperty("count");var offset=this.getViewProperty("offset");var indices=this.getViewProperty("indices");for(i=0;i<count;i++){ii=indices?indices[i+offset]:i+offset;a[i]=this.getContentTemplate(ii).toString()}return a.join("")});obj.setContent("end","")};
 AW.Tree.Group=AW.System.Template.subclass();AW.Tree.Group.create=function(){var obj=this.prototype;obj.setTag("span");obj.setClass("tree","view");obj.setContent("start",function(){return this.$0?this.getItemTemplate():""});obj.setContent("items",function(){if(this.$0 && !this.getViewProperty("expanded")){return ""}else{return this.getContentTemplate()}});obj.setContent("end","")};
 AW.Tree.Control=AW.UI.List.subclass();AW.Tree.Control.create=function(){var obj=this.prototype;obj.defineTemplate("group",new AW.Tree.Group);obj.setItemTemplate(new AW.Tree.Item);obj.setScrollTemplate(function(){return this.getGroupTemplate(0)});obj.getContentTemplate().mapTemplate("item",function(i){return this.$owner.getGroupTemplate(i)});obj.defineViewProperty("expanded",false);obj.onTreeSignClicked=function(src,i){if(this.getViewIndices(i)){this.setViewExpanded(!this.getViewExpanded(i),i)}};obj.onViewExpandedChanged=function(e,i){this.getGroupTemplate(i).refresh()}};AW.UI.Tree=AW.Tree.Control;
 AW.Tree.Grid=AW.Grid.Control.subclass();AW.Tree.Grid.create=function(){var obj=this.prototype;obj.onGroupTemplateChanged=function(group){group.mapTemplate("content","rows");group.mapTemplate("item","row");group.mapModel("view","row")};obj.defineTemplate("group",new AW.Tree.Group);obj.onRowsTemplateChanged=function(rows){rows.mapTemplate("item",function(i){return this.$owner.getGroupTemplate(i)});rows.mapModel("view","row")};obj.setRowsTemplate(new AW.Grid.Rows);obj.setTemplate("cell",new AW.Tree.Item,0);obj.getContentTemplate().mapTemplate("panel",function(i){switch(i){case 0:return this.getHeadersTemplate();case 1:return this.getGroupTemplate(0);case 2:return this.getFootersTemplate()}});obj.defineRowProperty("expanded",false);obj.getCellTemplate(0).mapModel("view",function(p){return this.$owner.getRowProperty(p,this.$1)});obj.setAction("treeSignClicked",function(src,i,j){var expanded=this.getRowExpanded(j);this.setRowExpanded(!expanded,j);this.getGroupTemplate(j).refresh()});obj.onScrollLeftChanged=function(x){var e1=this.getGroupTemplate(0).element();if(e1){e1.parentNode.scrollLeft=x}};obj._sortController={};obj.setVirtualMode(false)};
 AW.Tree.Extended=AW.Tree.Grid.subclass();AW.Tree.Extended.create=function(){AW.Grid.Extended.create.call(this);var obj=this.prototype};
 AW.HTTP.Request=AW.System.Model.subclass();AW.HTTP.Request.create=function(){var obj=this.prototype;obj.defineProperty("URL");obj.defineProperty("async",true);obj.defineProperty("requestMethod","GET");obj.defineProperty("requestData","");obj.defineProperty("responseText",function(){return this._http?this._http.responseText:""});obj.defineProperty("responseXML",function(){return this._http?this._http.responseXML:""});obj.defineProperty("username",null);obj.defineProperty("password",null);obj.setNamespace=function(name,value){this._namespaces+=" xmlns:"+name+"=\""+value+"\""};obj._namespaces="";obj.setParameter=function(name,value){this["_"+name+"Parameter"]=value;if(!this._parameters.match(name)){this._parameters+=" "+name}};obj._parameters="";obj.setRequestHeader=function(name,value){this["_"+name+"Header"]=value;if(!this._headers.match(name)){this._headers+=" "+name}};obj._headers="";obj.setRequestHeader("Content-Type","application/x-www-form-urlencoded");obj.getResponseHeader=function(name){return this._http?this._http.getResponseHeader(name):""};obj.request=function(){var self=this;this._ready=false;var i,name,value,data="",params=this._parameters.split(" ");for(i=1;i<params.length;i++){name=params[i];value=this["_"+name+"Parameter"];if(typeof value=="function"){value=value()}data+=name+"="+encodeURIComponent(value)+"&"}var URL=this._URL;if((this._requestMethod !="POST")&& data){URL+="?"+data;data=null}this._http=window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP"):new XMLHttpRequest;this._http.open(this._requestMethod,URL,this._async,this._username,this._password);var headers=this._headers.split(" ");for(i=1;i<headers.length;i++){name=headers[i];value=this["_"+name+"Header"];if(typeof value=="function"){value=value()}this._http.setRequestHeader(name,value)}this._http.send(data);if(this._async){this.timeout(wait,200)}else{returnResult()}function wait(){if(self._http.readyState==4){self._ready=true;returnResult()}else{self.timeout(wait,200)}}function returnResult(){if(self._http.responseXML && self._http.responseXML.hasChildNodes()){self.response(self._http.responseXML)}else{self.response(self._http.responseText)}}};obj.response=function(result){if(this.$owner){this.$owner.refresh()}};obj.isReady=function(){return this._ready}};
 AW.CSV.Table=AW.HTTP.Request.subclass();AW.CSV.Table.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.response=function(text){var i,s,table=[],a=text.split(/\r*\n/);var pattern=new RegExp("(^|\\t|,)(\"*|'*)(.*?)\\2(?=,|\\t|$)","g");for(i=0;i<a.length;i++){s=a[i].replace(/""/g,"'");s=s.replace(pattern,"$3\t");s=s.replace(/\t$/,"");if(s){table[i]=s.split(/\t/)}}this._data=table;if(this.$owner && this.$owner.setRowCount){this.$owner.setRowCount(this.getCount());this.$owner.refresh()}};obj._data=[];obj.getCount=function(){return this._data.length};obj.getIndex=function(i){return i};obj.getText=function(c,r){return this._data[r][c]};obj.getImage=function(){return ""};obj.getLink=function(){return ""};obj.getValue=function(i,j){var text=this.getText(i,j);var value=Number(text.replace(/[,%\$]/gi,"").replace(/\((.*)\)/,"-$1"));return isNaN(value)?text.toLowerCase()+" ":value}};
 AW.XML.Table=AW.HTTP.Request.subclass();AW.XML.Table.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.response=function(xml){this.setXML(xml);if(this.$owner && this.$owner.setRowCount){this.$owner.setRowCount(this.getCount());this.$owner.refresh()}};obj.defineProperty("XML");obj.setXML=function(xml){if(!xml.nodeType){var s=""+xml;xml=window.ActiveXObject?new ActiveXObject("MSXML2.DOMDocument"):new XMLDocument;xml.loadXML(s)}xml.setProperty("SelectionLanguage","XPath");if(this._namespaces){xml.setProperty("SelectionNamespaces",this._namespaces)}this._xml=xml;this._data=this._xml.selectSingleNode(this._dataPath);this._items=this._data?this._data.selectNodes(this._itemPath):null;this._ready=true};obj.getXML=function(){return this._xml};obj._dataPath="*";obj._itemPath="*";obj._valuePath="*";obj._valuesPath=[];obj._formats=[];obj.setColumns=function(array){this._valuesPath=array};obj.setRows=function(xpath){this._itemPath=xpath};obj.setTable=function(xpath){this._dataPath=xpath};obj.setFormat=function(format,index){this._formats=this._formats.concat();this._formats[index]=format};obj.setFormats=function(formats){this._formats=formats};obj.getCount=function(){if(!this._items){return 0}return this._items.length};obj.getIndex=function(i){return i};obj.getText=function(i,j){var node=this.getNode(i,j);var data=node?node.text:"";var format=this._formats[j];return format?format.dataToText(data):data};obj.getImage=function(){return "none"};obj.getLink=function(){return ""};obj.getValue=function(i,j){var node=this.getNode(i,j);var text=node?node.text:"";var format=this._formats[j];if(format){return format.dataToValue(text)}var value=Number(text.replace(/[,%\$]/gi,"").replace(/\((.*)\)/,"-$1"));return isNaN(value)?text.toLowerCase()+" ":value};obj.getNode=function(j,i){if(!this._items || !this._items[i]){return null}if(this._valuesPath[j]){return this._items[i].selectSingleNode(this._valuesPath[j])}else{return this._items[i].selectNodes(this._valuePath)[j]}}};
